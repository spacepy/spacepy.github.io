
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>spacepy.empiricals &#8212; SpacePy v0.4.1 Manual</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/default.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/copybutton.js"></script>
    
    <link rel="shortcut icon" href="../../_static/spacepy_favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../../index.html"><img src="../../_static/spacepy_logo.jpg" border="0" alt="spacepy_logo"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="https://spacepy.github.io/"">homepage</a>|&nbsp;</li>
        <li><a href="https://github.com/spacepy/spacepy">development</a>|&nbsp;</li>
        <li><a href="../../search.html">search</a>|&nbsp;</li>
       <li><a href="../../index.html">documentation </a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../spacepy.html" accesskey="U">spacepy</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">spacepy.empiricals</a></li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for spacepy.empiricals</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module with some useful empirical models (plasmapause, magnetopause, Lmax)</span>


<span class="sd">Authors: Steve Morley, Josef Koller</span>
<span class="sd">Institution: Los Alamos National Laboratory</span>
<span class="sd">Contact: smorley@lanl.gov</span>

<span class="sd">Copyright 2010 Los Alamos National Security, LLC.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.integrate</span> <span class="k">as</span> <span class="nn">integ</span>

<span class="kn">from</span> <span class="nn">spacepy</span> <span class="kn">import</span> <span class="n">help</span>
<span class="kn">import</span> <span class="nn">spacepy.datamodel</span> <span class="k">as</span> <span class="nn">dm</span>
<span class="kn">import</span> <span class="nn">spacepy.toolbox</span> <span class="k">as</span> <span class="nn">tb</span>
<span class="kn">import</span> <span class="nn">spacepy.omni</span> <span class="k">as</span> <span class="nn">om</span>
<span class="kn">import</span> <span class="nn">spacepy.time</span> <span class="k">as</span> <span class="nn">spt</span>

<span class="n">__contact__</span> <span class="o">=</span> <span class="s1">&#39;Steve Morley, smorley@lanl.gov&#39;</span>

<div class="viewcode-block" id="getLmax"><a class="viewcode-back" href="../../autosummary/spacepy.empiricals.getLmax.html#spacepy.empiricals.getLmax">[docs]</a><span class="k">def</span> <span class="nf">getLmax</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;JKemp&#39;</span><span class="p">,</span> <span class="n">dbase</span><span class="o">=</span><span class="s1">&#39;QDhourly&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    calculate a simple empirical model for Lmax - last closed drift-shell</span>

<span class="sd">    Uses the parametrized Lmax from:</span>
<span class="sd">    Koller and Morley (2010)</span>
<span class="sd">    &#39;Magnetopause shadowing effects for radiation belt models during high-speed solar wind streams&#39;</span>
<span class="sd">    American Geophysical Union, Fall Meeting 2010, abstract #SM13A-1787</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    ticks : spacepy.time.Ticktock</span>
<span class="sd">        Ticktock object of desired times</span>
<span class="sd">    model : string, optional</span>
<span class="sd">        &#39;JKemp&#39; (default - empirical model of J. Koller)</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    out : np.ndarray</span>
<span class="sd">        Lmax - L* of last closed drift shell</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>
<span class="sd">    &gt;&gt;&gt; from spacepy.empiricals import getLmax</span>
<span class="sd">    &gt;&gt;&gt; import spacepy.time as st</span>
<span class="sd">    &gt;&gt;&gt; import datetime</span>
<span class="sd">    &gt;&gt;&gt; ticks = st.tickrange(datetime.datetime(2000, 1, 1), datetime.datetime(2000, 1, 3), deltadays=1)</span>
<span class="sd">    array([ 7.4928412,  8.3585632,  8.6463423])</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>
<span class="sd">    spacepy.LANLstar.LANLmax</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">omni</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">get_omni</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">dbase</span><span class="o">=</span><span class="n">dbase</span><span class="p">)</span>
    <span class="n">Dst</span> <span class="o">=</span> <span class="n">omni</span><span class="p">[</span><span class="s1">&#39;Dst&#39;</span><span class="p">]</span>
    <span class="n">Lmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Dst</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;JKemp&#39;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">iDst</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Dst</span><span class="p">):</span>
            <span class="n">Lmax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.07e-5</span><span class="o">*</span><span class="n">iDst</span><span class="o">*</span><span class="n">iDst</span> <span class="o">+</span> <span class="mf">0.0436</span><span class="o">*</span><span class="n">iDst</span> <span class="o">+</span> <span class="mf">9.37</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid model selection&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Lmax</span></div>

<div class="viewcode-block" id="getPlasmaPause"><a class="viewcode-back" href="../../autosummary/spacepy.empiricals.getPlasmaPause.html#spacepy.empiricals.getPlasmaPause">[docs]</a><span class="k">def</span> <span class="nf">getPlasmaPause</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;M2002&#39;</span><span class="p">,</span> <span class="n">LT</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">omnivals</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plasmapause location model(s)</span>

<span class="sd">    CA1992 -- Carpenter, D. L., and R. R. Anderson, An ISEE/whistler</span>
<span class="sd">    model of equatorial electron density in the magnetosphere,</span>
<span class="sd">    J. Geophys. Res., 97, 1097, 1992.</span>
<span class="sd">    M2002 -- Moldwin, M. B., L. Downward, H. K. Rassoul, R. Amin,</span>
<span class="sd">    and R. R. Anderson, A new model of the location of the plasmapause:</span>
<span class="sd">    CRRES results, J. Geophys. Res., 107(A11), 1339,</span>
<span class="sd">    doi:10.1029/2001JA009211, 2002.</span>
<span class="sd">    RT1970 -- Rycroft, M. J., and J. O. Thomas, The magnetospheric</span>
<span class="sd">    plasmapause and the electron density trough at the alouette i</span>
<span class="sd">    orbit, Planetary and Space Science, 18(1), 65-80, 1970</span>


<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    ticks : spacepy.time.Ticktock</span>
<span class="sd">        TickTock object of desired times</span>
<span class="sd">    Lpp_model : string, optional</span>
<span class="sd">        &#39;CA1992&#39; or &#39;M2002&#39; (default)</span>
<span class="sd">        CA1992 returns the Carpenter and Anderson model,</span>
<span class="sd">        M2002 returns the Moldwin et al. model</span>
<span class="sd">    LT : int, float</span>
<span class="sd">        requested local time sector, &#39;all&#39; is valid option</span>
<span class="sd">    omnivals : spacepy.datamodel.SpaceData, dict</span>
<span class="sd">        dict-like containing UTC (datetimes) and Kp keys</span>

<span class="sd">    Warns</span>
<span class="sd">    =====</span>
<span class="sd">    RuntimeWarning</span>
<span class="sd">        If the CA1992 model is called with LT as it is not implemented </span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    out : float</span>
<span class="sd">        Plasmapause radius in Earth radii</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>
<span class="sd">    &gt;&gt;&gt; import spacepy.time as spt</span>
<span class="sd">    &gt;&gt;&gt; import spacepy.empiricals as emp</span>
<span class="sd">    &gt;&gt;&gt; ticks = spt.tickrange(&#39;2002-01-01T12:00:00&#39;,&#39;2002-01-04T00:00:00&#39;,.25)</span>
<span class="sd">    &gt;&gt;&gt; emp.getPlasmaPause(ticks)</span>
<span class="sd">    array([ 6.42140002,  6.42140002,  6.42140002,  6.42140002,  6.42140002,</span>
<span class="sd">        6.42140002,  6.42140002,  6.26859998,  5.772     ,  5.6574    ,</span>
<span class="sd">        5.6574    ])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">calcLpp</span><span class="p">(</span><span class="n">Kpmax</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">power</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">currLpp</span> <span class="o">=</span> <span class="n">A</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">Kpmax</span><span class="o">**</span><span class="n">power</span>
        <span class="k">return</span> <span class="n">currLpp</span>

    <span class="n">model_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CA1992&#39;</span><span class="p">,</span> <span class="s1">&#39;M2002&#39;</span><span class="p">,</span> <span class="s1">&#39;RT1970&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;CA1992&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">LT</span> <span class="o">!=</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;No LT dependence currently supported for CA1992 model&#39;</span><span class="p">,</span> <span class="ne">RuntimeWarning</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">model</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please specify a valid model:</span><span class="se">\n</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39; or &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">model_list</span><span class="p">)))</span>

    <span class="k">if</span> <span class="n">LT</span><span class="o">==</span><span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="n">parA</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CA1992&#39;</span><span class="p">:</span> <span class="mf">5.6</span><span class="p">,</span>  <span class="s1">&#39;M2002&#39;</span><span class="p">:</span> <span class="mf">5.39</span><span class="p">,</span>  <span class="s1">&#39;RT1970&#39;</span><span class="p">:</span> <span class="mf">5.64</span><span class="p">}</span>
        <span class="n">parB</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CA1992&#39;</span><span class="p">:</span> <span class="mf">0.46</span><span class="p">,</span> <span class="s1">&#39;M2002&#39;</span><span class="p">:</span> <span class="mf">0.382</span><span class="p">,</span> <span class="s1">&#39;RT1970&#39;</span><span class="p">:</span> <span class="mf">0.78</span><span class="p">}</span>
        <span class="n">priorvals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CA1992&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">24</span><span class="p">),</span>
                     <span class="s1">&#39;M2002&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
                     <span class="s1">&#39;RT1970&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)}</span>
        <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">parA</span><span class="p">[</span><span class="n">model</span><span class="p">],</span> <span class="n">parB</span><span class="p">[</span><span class="n">model</span><span class="p">]</span>
        <span class="n">prior</span> <span class="o">=</span> <span class="n">priorvals</span><span class="p">[</span><span class="n">model</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">LT</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please specify a valid LT:</span><span class="se">\n</span><span class="s2">&#39;all&#39; or a numeric type&quot;</span><span class="p">)</span>
        <span class="n">parA</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CA1992&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.6</span><span class="p">]</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span>
                <span class="s1">&#39;M2002&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.7</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="p">[</span><span class="mf">6.05</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="p">[</span><span class="mf">5.2</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="p">[</span><span class="mf">4.45</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="p">[</span><span class="mf">5.7</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span>
                <span class="s1">&#39;RT1970&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.64</span><span class="p">]</span><span class="o">*</span><span class="mi">24</span><span class="p">}</span>
        <span class="n">parB</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CA1992&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.46</span><span class="p">]</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span>
                <span class="s1">&#39;M2002&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.42</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="p">[</span><span class="mf">0.573</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="p">[</span><span class="mf">0.425</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="p">[</span><span class="mf">0.167</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="p">[</span><span class="mf">0.42</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span>
                <span class="s1">&#39;RT1970&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.78</span><span class="p">]</span><span class="o">*</span><span class="mi">24</span><span class="p">}</span>
        <span class="n">priorvals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CA1992&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">24</span><span class="p">)]</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span>
                     <span class="s1">&#39;M2002&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">12</span><span class="p">)]</span><span class="o">*</span><span class="mi">24</span><span class="p">,</span>
                     <span class="s1">&#39;RT1970&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span><span class="o">*</span><span class="mi">24</span><span class="p">}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">LThr</span> <span class="o">=</span> <span class="n">long</span><span class="p">(</span><span class="n">LT</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
            <span class="n">LThr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">LT</span><span class="p">)</span>
        <span class="n">prior</span> <span class="o">=</span> <span class="n">priorvals</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">LThr</span><span class="p">]</span>
        <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">parA</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">LThr</span><span class="p">],</span> <span class="n">parB</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">LThr</span><span class="p">]</span>

    <span class="n">st</span><span class="p">,</span> <span class="n">en</span> <span class="o">=</span> <span class="n">ticks</span><span class="o">.</span><span class="n">UTC</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">prior</span><span class="p">,</span> <span class="n">ticks</span><span class="o">.</span><span class="n">UTC</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">omnivals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">omdat</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">get_omni</span><span class="p">(</span><span class="n">spt</span><span class="o">.</span><span class="n">tickrange</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">en</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="mf">24.0</span><span class="p">),</span> <span class="n">dbase</span><span class="o">=</span><span class="s1">&#39;QDhourly&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#now test for sanity of input</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">omnivals</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Not a valid input type for omnivals, expected spacepy.datamodel.SpaceData&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">assert</span> <span class="s1">&#39;UTC&#39;</span> <span class="ow">in</span> <span class="n">omnivals</span>
            <span class="k">assert</span> <span class="s1">&#39;Kp&#39;</span> <span class="ow">in</span> <span class="n">omnivals</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Required data not found in input dict-like (omnivals)&#39;</span><span class="p">)</span>
        <span class="n">omdat</span> <span class="o">=</span> <span class="n">omnivals</span>

    <span class="n">einds</span><span class="p">,</span> <span class="n">oinds</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">tOverlap</span><span class="p">([</span><span class="n">st</span><span class="p">,</span> <span class="n">en</span><span class="p">],</span> <span class="n">omdat</span><span class="p">[</span><span class="s1">&#39;UTC&#39;</span><span class="p">])</span>
    <span class="n">utc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">omdat</span><span class="p">[</span><span class="s1">&#39;UTC&#39;</span><span class="p">])[</span><span class="n">oinds</span><span class="p">]</span>
    <span class="n">Kp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">omdat</span><span class="p">[</span><span class="s1">&#39;Kp&#39;</span><span class="p">])[</span><span class="n">oinds</span><span class="p">]</span>
    <span class="n">Lpp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ticks</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="s1">&#39;RT1970&#39;</span><span class="p">:</span>
        <span class="n">power</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">power</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ticks</span><span class="o">.</span><span class="n">UTC</span><span class="p">):</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">t1</span><span class="o">-</span><span class="n">prior</span>
        <span class="n">iprevday</span><span class="p">,</span> <span class="n">dum</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">tOverlap</span><span class="p">(</span><span class="n">utc</span><span class="p">,</span> <span class="p">[</span><span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">iprevday</span><span class="p">:</span>
            <span class="n">Kpmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Kp</span><span class="p">[</span><span class="n">iprevday</span><span class="p">])</span>
            <span class="n">Lpp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">calcLpp</span><span class="p">(</span><span class="n">Kpmax</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Lpp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">return</span> <span class="n">Lpp</span></div>


<div class="viewcode-block" id="getMagnetopause"><a class="viewcode-back" href="../../autosummary/spacepy.empiricals.getMagnetopause.html#spacepy.empiricals.getMagnetopause">[docs]</a><span class="k">def</span> <span class="nf">getMagnetopause</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">LTs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dbase</span><span class="o">=</span><span class="s1">&#39;QDhourly&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculates the Shue et al. (1997) position in equatorial plane</span>

<span class="sd">    Shue et al. (1997), A new functional form to study the solar wind </span>
<span class="sd">    control of the magnetopause size and shape, J. Geophys. Res., 102(A5), </span>
<span class="sd">    9497–9511, doi:10.1029/97JA00196.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    ticks : spacepy.time.Ticktock</span>
<span class="sd">        TickTock object of desired times (will be interpolated from hourly OMNI data)</span>
<span class="sd">        OR dictionary of form {&#39;P&#39;: [], &#39;Bz&#39;: []}</span>
<span class="sd">        Where P is SW ram pressure [nPa] and Bz is IMF Bz (GSM) [nT]</span>
<span class="sd">    LTs : array-like</span>
<span class="sd">        Array-like of local times for evaluating the magnetopause model. Default is</span>
<span class="sd">        6 LT to 18 LT in steps of 20 minutes.</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    out : array</span>
<span class="sd">        NxMx2 array of magnetopause positions [Re]</span>
<span class="sd">        N is number of timesteps, M is number of local times. The 2 positions</span>
<span class="sd">        are the X_GSE and Y_GSE positions of the magnetopause</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>
<span class="sd">    &gt;&gt;&gt; import spacepy.time as spt</span>
<span class="sd">    &gt;&gt;&gt; import spacepy.empiricals as emp</span>
<span class="sd">    &gt;&gt;&gt; ticks = spt.Ticktock([&#39;2002-01-01T12:00:00&#39;,&#39;2002-01-04T00:00:00&#39;])</span>
<span class="sd">    &gt;&gt;&gt; localtimes = [13,12,11]</span>
<span class="sd">    &gt;&gt;&gt; emp.getMagnetopause(ticks, LTs=localtimes)</span>
<span class="sd">    array([[[ 10.27674331,  -2.75364507],</span>
<span class="sd">        [ 10.52909163,   0.        ],</span>
<span class="sd">        [ 10.27674331,   2.75364507]],</span>
<span class="sd">       [[ 10.91791834,  -2.9254474 ],</span>
<span class="sd">        [ 11.18712131,   0.        ],</span>
<span class="sd">        [ 10.91791834,   2.9254474 ]]])</span>
<span class="sd">    &gt;&gt;&gt; emp.getMPstandoff(ticks) #should give same result as getMagnetopause for 12LT</span>
<span class="sd">    array([ 10.52909163,  11.18712131])</span>
<span class="sd">    </span>
<span class="sd">    To plot the magnetopause:</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; import spacepy.plot as splot</span>
<span class="sd">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">    &gt;&gt;&gt; localtimes = np.arange(5, 19.1, 0.5)</span>
<span class="sd">    &gt;&gt;&gt; mp_pos = emp.getMagnetopause(ticks, localtimes)</span>
<span class="sd">    &gt;&gt;&gt; plt.plot(mp_pos[0,:,0], mp_pos[0,:,1])</span>
<span class="sd">    &gt;&gt;&gt; ax1 = plt.gca()</span>
<span class="sd">    &gt;&gt;&gt; ax1.set_xlim([-5,20])</span>
<span class="sd">    &gt;&gt;&gt; ax1.set_xlabel(&#39;X$_{GSE}$ [R$_E$]&#39;)</span>
<span class="sd">    &gt;&gt;&gt; ax1.set_ylabel(&#39;Y$_{GSE}$ [R$_E$]&#39;)</span>
<span class="sd">    &gt;&gt;&gt; splot.dual_half_circle(ax=ax1)</span>
<span class="sd">    &gt;&gt;&gt; ax1.axes.set_aspect(&#39;equal&#39;)</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">r0</span> <span class="o">=</span> <span class="n">getMPstandoff</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">dbase</span><span class="o">=</span><span class="n">dbase</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">LTs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">LTs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">18.1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">ticks</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">LTs</span><span class="p">)])</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">ticks</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">LTs</span><span class="p">),</span> <span class="mi">2</span><span class="p">])</span>

    <span class="n">angs</span> <span class="o">=</span> <span class="p">(</span><span class="mf">12.0</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">LTs</span><span class="p">))</span><span class="o">*</span><span class="mf">15.0</span>

    <span class="n">costheta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">angs</span><span class="p">))</span>
    <span class="n">sintheta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">angs</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">ct</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">costheta</span><span class="p">):</span>
        <span class="n">r</span><span class="p">[:,</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">ct</span><span class="p">))</span><span class="o">**</span><span class="n">alpha</span>
    <span class="n">out</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">costheta</span> <span class="c1">#Xgse</span>
    <span class="n">out</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">sintheta</span> <span class="c1">#Ygse</span>

    <span class="k">return</span> <span class="n">out</span></div>


<div class="viewcode-block" id="getMPstandoff"><a class="viewcode-back" href="../../autosummary/spacepy.empiricals.getMPstandoff.html#spacepy.empiricals.getMPstandoff">[docs]</a><span class="k">def</span> <span class="nf">getMPstandoff</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">dbase</span><span class="o">=</span><span class="s1">&#39;QDhourly&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the Shue et al. (1997) subsolar magnetopause radius</span>

<span class="sd">    Shue et al. (1997), A new functional form to study the solar wind </span>
<span class="sd">    control of the magnetopause size and shape, J. Geophys. Res., 102(A5), </span>
<span class="sd">    9497–9511, doi:10.1029/97JA00196.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    ticks : spacepy.time.Ticktock</span>
<span class="sd">        TickTock object of desired times (will be interpolated from hourly OMNI data)</span>
<span class="sd">        OR dictionary of form {&#39;P&#39;: [], &#39;Bz&#39;: []}</span>
<span class="sd">        Where P is SW ram pressure [nPa] and Bz is IMF Bz (GSM) [nT]</span>
<span class="sd">    alpha : list</span>
<span class="sd">        Used as an optional return value to obtain the flaring angles. To use, assign</span>
<span class="sd">        an empty list and pass to this function through the keyword argument. The list </span>
<span class="sd">        will be modified in place, adding the flaring angles for each time step.</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    out : float</span>
<span class="sd">        Magnetopause (sub-solar point) standoff distance [Re]</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>
<span class="sd">    &gt;&gt;&gt; import spacepy.time as spt</span>
<span class="sd">    &gt;&gt;&gt; import spacepy.empiricals as emp</span>
<span class="sd">    &gt;&gt;&gt; ticks = spt.tickrange(&#39;2002-01-01T12:00:00&#39;,&#39;2002-01-04T00:00:00&#39;,.25)</span>
<span class="sd">    &gt;&gt;&gt; emp.getMPstandoff(ticks)</span>
<span class="sd">    array([ 10.57319537,  10.91327764,  10.75086873,  10.77577207,</span>
<span class="sd">         9.78180261,  11.0374474 ,  11.4065    ,  11.27555451,</span>
<span class="sd">        11.47988573,  11.8202582 ,  11.23834814])</span>
<span class="sd">    &gt;&gt;&gt; data = {&#39;P&#39;: [2,4], &#39;Bz&#39;: [-2.4, -2.4]}</span>
<span class="sd">    &gt;&gt;&gt; emp.getMPstandoff(data)</span>
<span class="sd">    array([ 9.96096838,  8.96790412])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span> <span class="o">==</span> <span class="n">spt</span><span class="o">.</span><span class="n">Ticktock</span><span class="p">:</span>
        <span class="n">omni</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">get_omni</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">dbase</span><span class="o">=</span><span class="n">dbase</span><span class="p">)</span>
        <span class="n">P</span><span class="p">,</span> <span class="n">Bz</span> <span class="o">=</span> <span class="n">omni</span><span class="p">[</span><span class="s1">&#39;Pdyn&#39;</span><span class="p">],</span> <span class="n">omni</span><span class="p">[</span><span class="s1">&#39;BzIMF&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span> 
        <span class="n">P</span><span class="p">,</span> <span class="n">Bz</span> <span class="o">=</span> <span class="n">ticks</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">],</span> <span class="n">ticks</span><span class="p">[</span><span class="s1">&#39;Bz&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">Bz</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">Bz</span> <span class="o">=</span> <span class="p">[</span><span class="n">Bz</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Invalid Input type&#39;</span><span class="p">))</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Initialize r0 and make P and Bz numpy arrays</span>
        <span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">Bz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Bz</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>

        <span class="c1"># Find where Bz &gt;= 0 and where it is &lt; 0</span>
        <span class="n">iBzPos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Bz</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">iBzNeg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Bz</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Calculate r0</span>
        <span class="n">r0</span><span class="p">[</span><span class="n">iBzPos</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.4</span> <span class="o">+</span> <span class="mf">0.013</span><span class="o">*</span><span class="n">Bz</span><span class="p">[</span><span class="n">iBzPos</span><span class="p">])</span><span class="o">*</span><span class="n">P</span><span class="p">[</span><span class="n">iBzPos</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mf">6.6</span><span class="p">)</span>
        <span class="n">r0</span><span class="p">[</span><span class="n">iBzNeg</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">11.4</span> <span class="o">+</span> <span class="mf">0.140</span><span class="o">*</span><span class="n">Bz</span><span class="p">[</span><span class="n">iBzNeg</span><span class="p">])</span><span class="o">*</span><span class="n">P</span><span class="p">[</span><span class="n">iBzNeg</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mf">6.6</span><span class="p">)</span>
        <span class="n">flarang</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.58</span> <span class="o">-</span> <span class="mf">0.01</span><span class="o">*</span><span class="n">Bz</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="mf">0.01</span><span class="o">*</span><span class="n">P</span><span class="p">)</span>
        <span class="n">alpha</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">flarang</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">r0</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Please check for valid input types&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="getDststar"><a class="viewcode-back" href="../../autosummary/spacepy.empiricals.getDststar.html#spacepy.empiricals.getDststar">[docs]</a><span class="k">def</span> <span class="nf">getDststar</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;OBrien&#39;</span><span class="p">,</span> <span class="n">dbase</span><span class="o">=</span><span class="s1">&#39;QDhourly&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the pressure-corrected Dst index, Dst*</span>

<span class="sd">    We need to add in the references to the models here!</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    ticks : spacepy.time.Ticktock</span>
<span class="sd">        TickTock object of desired times (will be interpolated from hourly OMNI data)</span>
<span class="sd">        OR dictionary including &#39;Pdyn&#39; and &#39;Dst&#39; keys where data are lists or arrays</span>
<span class="sd">        and Dst is in [nT], and Pdyn is in [nPa]</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    out : float</span>
<span class="sd">        Dst* - the pressure corrected Dst index from OMNI [nT]</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>
<span class="sd">    Coefficients are applied to the standard formulation e.g. Burton et al., 1975</span>
<span class="sd">    of Dst* = Dst - b*sqrt(Pdyn) + c</span>
<span class="sd">    The default is the O&#39;Brien and McPherron model (2002).</span>
<span class="sd">    Other options are Burton et al. (1975) and Borovsky and Denton (2010)</span>

<span class="sd">    &gt;&gt;&gt; import spacepy.time as spt</span>
<span class="sd">    &gt;&gt;&gt; import spacepy.omni as om</span>
<span class="sd">    &gt;&gt;&gt; import spacepy.empiricals as emp</span>
<span class="sd">    &gt;&gt;&gt; ticks = spt.tickrange(&#39;2000-10-16T00:00:00&#39;, &#39;2000-10-31T12:00:00&#39;, 1/24.)</span>
<span class="sd">    &gt;&gt;&gt; dststar = emp.getDststar(ticks)</span>
<span class="sd">    &gt;&gt;&gt; dststar[0]</span>
<span class="sd">    -21.317220132108943</span>

<span class="sd">    User-determined coefficients can also be supplied as a two-element list</span>
<span class="sd">    or tuple of the form (b,c), e.g.</span>

<span class="sd">    &gt;&gt;&gt; dststar = emp.getDststar(ticks, model=(2,11)) #b is extreme driving from O&#39;Brien</span>

<span class="sd">    We have chosen the OBrien model as the default here as this was rigorously</span>
<span class="sd">    determined from a very long data set and is pertinent to most conditions.</span>
<span class="sd">    It is, however, the most conservative correction. Additionally, Siscoe,</span>
<span class="sd">    McPherron and Jordanova (2005) argue that the pressure contribution to Dst diminishes</span>
<span class="sd">    during magnetic storms.</span>

<span class="sd">    To show the relative differences, run the following example:</span>

<span class="sd">    &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">    &gt;&gt;&gt; params = [(&#39;Burton&#39;,&#39;k-&#39;), (&#39;OBrien&#39;,&#39;r-&#39;), (&#39;Borovsky&#39;,&#39;b-&#39;)]</span>
<span class="sd">    &gt;&gt;&gt; for model, col in params:</span>
<span class="sd">            dststar = getDststar(ticks, model=model)</span>
<span class="sd">            plt.plot(ticks.UTC, dststar, col)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Burton&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">15.8</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
                    <span class="s1">&#39;OBrien&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">7.26</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
                    <span class="s1">&#39;Borovsky&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">20.7</span><span class="p">,</span><span class="mf">27.7</span><span class="p">)}</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">model_params</span><span class="p">[</span><span class="n">model</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid pressure correction model selected&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">model</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">model</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid coefficients set: must be of form (b,c)&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">spt</span><span class="o">.</span><span class="n">Ticktock</span><span class="p">):</span>
        <span class="n">omni</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">get_omni</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">dbase</span><span class="o">=</span><span class="n">dbase</span><span class="p">)</span>
        <span class="n">P</span><span class="p">,</span> <span class="n">Dst</span> <span class="o">=</span> <span class="n">omni</span><span class="p">[</span><span class="s1">&#39;Pdyn&#39;</span><span class="p">],</span> <span class="n">omni</span><span class="p">[</span><span class="s1">&#39;Dst&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">P</span><span class="p">,</span> <span class="n">Dst</span> <span class="o">=</span> <span class="n">ticks</span><span class="p">[</span><span class="s1">&#39;Pdyn&#39;</span><span class="p">],</span> <span class="n">ticks</span><span class="p">[</span><span class="s1">&#39;Dst&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">P</span><span class="p">,</span> <span class="n">Dst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">P</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Dst</span><span class="p">)</span>

    <span class="c1">#get Dst*</span>
    <span class="n">Dststar</span> <span class="o">=</span> <span class="n">Dst</span> <span class="o">-</span> <span class="n">b</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">+</span> <span class="n">c</span>

    <span class="k">return</span> <span class="n">Dststar</span></div>


<div class="viewcode-block" id="getExpectedSWTemp"><a class="viewcode-back" href="../../autosummary/spacepy.empiricals.getExpectedSWTemp.html#spacepy.empiricals.getExpectedSWTemp">[docs]</a><span class="k">def</span> <span class="nf">getExpectedSWTemp</span><span class="p">(</span><span class="n">velo</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;XB15&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Return the expected solar wind temperature based on the bulk velocity</span>
<span class="sd">    </span>
<span class="sd">    The formulations used by this function are those given by,</span>
<span class="sd">    L87  -- Lopez, R.E., J. Geophys. Res., 92, 11189-11194, 1987</span>
<span class="sd">    BS06 -- Borovsky, J.E. and J.T. Steinberg, Geophysical Monograph Series 167, 59-76, 2006</span>
<span class="sd">    XB15 -- Xu, F. and J.E. Borovsky, J. Geophys. Res., 120, 70-100, 2015</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    velo : array-like</span>
<span class="sd">        Array like of solar wind bulk velocity values [km/s]</span>

<span class="sd">    model : str [optional]</span>
<span class="sd">        Name of model to use. Valid choices are L87, BS06 and XB15. Default is XB15</span>

<span class="sd">    units : str [optional]</span>
<span class="sd">        Units for output temperature, options are eV or K. Default is Kelvin [K]</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    Texp : array-like</span>
<span class="sd">        The expected solar wind temperature given the bulk velocity [K] or [eV]</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">velo</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">bs06</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Borovsky and Steinberg 2006, Geophysical Monograph - median values&#39;&#39;&#39;</span>
        <span class="n">Texp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="n">Texp</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">Texp</span><span class="p">[</span><span class="n">v</span><span class="o">&lt;</span><span class="mi">372</span><span class="p">]</span>  <span class="o">=</span> <span class="mf">1.28e-8</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">v</span><span class="o">&lt;</span><span class="mi">372</span><span class="p">]</span><span class="o">**</span><span class="mf">3.324</span>
        <span class="n">Texp</span><span class="p">[</span><span class="n">v</span><span class="o">&gt;=</span><span class="mi">372</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0572</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">v</span><span class="o">&gt;=</span><span class="mi">372</span><span class="p">]</span> <span class="o">-</span> <span class="mf">16.79</span>
        <span class="k">return</span> <span class="n">Texp</span>

    <span class="k">def</span> <span class="nf">xb15</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Xu and Borovsky 2015, JGR&#39;&#39;&#39;</span>
        <span class="n">Texp</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="o">/</span><span class="mf">258.0</span><span class="p">)</span><span class="o">**</span><span class="mf">3.113</span>
        <span class="k">return</span> <span class="n">Texp</span>

    <span class="k">def</span> <span class="nf">l87</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Lopez 1987, JGR - Tables 1&amp;2 [T(V)] from IMP-8&#39;&#39;&#39;</span>
        <span class="n">Texp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="n">Texp</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">Texp</span><span class="p">[</span><span class="n">v</span><span class="o">&lt;</span><span class="mi">500</span><span class="p">]</span>  <span class="o">=</span> <span class="p">(</span><span class="mf">0.031</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">v</span><span class="o">&lt;</span><span class="mi">500</span><span class="p">]</span> <span class="o">-</span> <span class="mf">5.1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">Texp</span><span class="p">[</span><span class="n">v</span><span class="o">&gt;=</span><span class="mi">500</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.02</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">v</span><span class="o">&gt;=</span><span class="mi">500</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">return</span> <span class="n">Texp</span><span class="o">*</span><span class="mf">1e3</span><span class="o">/</span><span class="mf">1.16045221e4</span> <span class="c1">#return in eV</span>

    <span class="n">formulae</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;BS06&#39;</span><span class="p">:</span> <span class="n">bs06</span><span class="p">,</span> <span class="s1">&#39;XB15&#39;</span><span class="p">:</span> <span class="n">xb15</span><span class="p">,</span> <span class="s1">&#39;L87&#39;</span><span class="p">:</span> <span class="n">l87</span><span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">mod</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">Texp</span> <span class="o">=</span> <span class="n">formulae</span><span class="p">[</span><span class="n">mod</span><span class="p">](</span><span class="n">v</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Invalid model specified for SW temperature&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;k&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Texp</span><span class="o">*</span><span class="mf">1.16045221e4</span>
    <span class="k">elif</span> <span class="n">units</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;ev&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Texp</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid units specified for SW temperature, must be &quot;K&quot; or &quot;eV&quot;&#39;</span><span class="p">)</span></div>
    

<div class="viewcode-block" id="vampolaPA"><a class="viewcode-back" href="../../autosummary/spacepy.empiricals.vampolaPA.html#spacepy.empiricals.vampolaPA">[docs]</a><span class="k">def</span> <span class="nf">vampolaPA</span><span class="p">(</span><span class="n">omniflux</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Pitch angle model of sin^n form</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    omniflux : arraylike or float</span>
<span class="sd">        omnidirectional number flux data</span>

<span class="sd">    order : integer or float (optional)</span>
<span class="sd">        order of sin^n functional form for distribution (default=2)</span>

<span class="sd">    alphas : arraylike (optional)</span>
<span class="sd">        pitch angles at which to evaluate the differential number flux</span>
<span class="sd">        (default is 5 to 90 degrees in 36 steps)</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    dnflux : array</span>
<span class="sd">        differential number flux corresponding to pitch angles alphas</span>
<span class="sd">    alphas : array</span>
<span class="sd">        pitch angles at which the differential number flux was evaluated</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>
<span class="sd">    Omnidirectional number flux of [3000, 6000]</span>

<span class="sd">    &gt;&gt;&gt; from spacepy.empiricals import vampolaPA</span>
<span class="sd">    &gt;&gt;&gt; vampolaPA(3000, alpha=[45, 90])</span>
<span class="sd">    (array([ 179.04931098,  358.09862196]), [45, 90])</span>
<span class="sd">    &gt;&gt;&gt; data, pas = vampolaPA([3000, 6000], alpha=[45, 90])</span>
<span class="sd">    &gt;&gt;&gt; pas</span>
<span class="sd">    [45, 90]</span>
<span class="sd">    &gt;&gt;&gt; data</span>
<span class="sd">    array([[ 179.04931098,  358.09862196],</span>
<span class="sd">       [ 358.09862196,  716.19724391]])</span>

<span class="sd">    Notes</span>
<span class="sd">    =====</span>
<span class="sd">    Directional number flux integrated over pitch angle from 0 to 90 degrees</span>
<span class="sd">    is a factor of 4*pi lower than omnidirectional number flux.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="n">tb</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">18</span><span class="p">)}</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">omniflux</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
        <span class="n">omniflux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">omniflux</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">omniflux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">([</span><span class="n">omniflux</span><span class="p">])</span>

    <span class="c1">#substitute defaults</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">defaults</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">],</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">])</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">omniflux</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;order must be either single-valued or the same length as omniflux&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">([</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">omniflux</span><span class="p">))</span>
    <span class="n">normfac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">sinfunc</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]):</span> <span class="c1">#define distribution function</span>
        <span class="n">dum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dum</span><span class="o">**</span><span class="n">order</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">tmporder</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]):</span>
        <span class="n">sinfunc_o</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">sinfunc</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">tmporder</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">normfac</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">omniflux</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">integ</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">sinfunc_o</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1">#now make the differential number flux</span>
    <span class="n">dnflux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">omniflux</span><span class="p">)))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">])):</span>
        <span class="n">dnflux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">normfac</span> <span class="o">*</span> <span class="n">sinfunc</span><span class="p">(</span><span class="n">a_val</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dnflux</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span></div>


<div class="viewcode-block" id="getVampolaOrder"><a class="viewcode-back" href="../../autosummary/spacepy.empiricals.getVampolaOrder.html#spacepy.empiricals.getVampolaOrder">[docs]</a><span class="k">def</span> <span class="nf">getVampolaOrder</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Empirical lookup of power for sin^n pitch angle model from Vampola (1996)</span>

<span class="sd">    Vampola, A.L. Outer zone energetic electron environment update, </span>
<span class="sd">    Final Report of ESA/ESTEC/WMA/P.O. 151351, ESA-ESTEC, Noordwijk, </span>
<span class="sd">    The Netherlands, 1996.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    L : arraylike or float</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    order : array</span>
<span class="sd">        coefficient for sin^n model corresponding to McIlwain L (computed for OP77?)</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>
<span class="sd">    Apply Vampola pitch angle model at L=[4, 6.6]</span>

<span class="sd">    &gt;&gt;&gt; from spacepy.empiricals import vampolaPA, getVampolaOrder</span>
<span class="sd">    &gt;&gt;&gt; order = getVampolaOrder([4,6.6])</span>
<span class="sd">    &gt;&gt;&gt; order</span>
<span class="sd">    array([ 3.095 ,  1.6402])</span>
<span class="sd">    &gt;&gt;&gt; vampolaPA([3000, 3000], alpha=[45, 90], order=order)</span>
<span class="sd">    (array([[ 140.08798878,  192.33572182],</span>
<span class="sd">        [ 409.49143136,  339.57417256]]), [45, 90])</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">lmc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mf">8.00001</span><span class="p">,</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="n">vamp_n</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.38</span><span class="p">,</span> <span class="mf">5.078</span><span class="p">,</span> <span class="mf">4.669</span><span class="p">,</span> <span class="mf">3.916</span><span class="p">,</span> <span class="mf">3.095</span><span class="p">,</span> <span class="mf">2.494</span><span class="p">,</span> <span class="mf">2.151</span><span class="p">,</span> <span class="mf">1.998</span><span class="p">,</span> <span class="mf">1.899</span><span class="p">,</span>
              <span class="mf">1.942</span><span class="p">,</span> <span class="mf">1.974</span><span class="p">,</span> <span class="mf">1.939</span><span class="p">,</span> <span class="mf">1.970</span><span class="p">,</span> <span class="mf">2.136</span><span class="p">,</span> <span class="mf">1.775</span><span class="p">,</span> <span class="mf">1.438</span><span class="p">,</span> <span class="mf">1.254</span><span class="p">,</span> <span class="mf">1.194</span><span class="p">,</span>
              <span class="mf">1.046</span><span class="p">,</span> <span class="mf">0.989</span><span class="p">,</span> <span class="mf">0.852</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span> <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">L</span><span class="p">]</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
    <span class="c1">#if outside valid range, use end value</span>
    <span class="n">L</span><span class="p">[</span><span class="n">L</span><span class="o">&lt;=</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">L</span><span class="p">[</span><span class="n">L</span><span class="o">&gt;=</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="c1">#interpolate to get order for the given L</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">lmc</span><span class="p">,</span> <span class="n">vamp_n</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">order</span></div>


<div class="viewcode-block" id="omniFromDirectionalFlux"><a class="viewcode-back" href="../../autosummary/spacepy.empiricals.omniFromDirectionalFlux.html#spacepy.empiricals.omniFromDirectionalFlux">[docs]</a><span class="k">def</span> <span class="nf">omniFromDirectionalFlux</span><span class="p">(</span><span class="n">fluxarr</span><span class="p">,</span> <span class="n">alphas</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Calculate omnidirectional flux [(s cm^2 kev)^-1] from directional flux [(s sr cm^2 keV)^-1] array</span>

<span class="sd">    J = 2.pi integ(j sin(a) da)</span>
<span class="sd">    If kwarg &#39;norm&#39; is True (default), the omni flux is normalized by 4.pi to make it per steradian,</span>
<span class="sd">    in line with the PRBEM guidelines</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    fluxarr : arraylike</span>
<span class="sd">        Array of directional flux values</span>
<span class="sd">    alphas : arraylike</span>
<span class="sd">        Array of pitch angles corresponding to fluxarr</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    omniflux : float</span>
<span class="sd">        Omnidirectional flux value</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>
<span class="sd">    Roundtrip from omni flux, to directional flux (Vampola model),</span>
<span class="sd">    integrate to get back to omni flux.</span>

<span class="sd">    &gt;&gt;&gt; from spacepy.empiricals import vampolaPA, omniFromDirectionalFlux</span>
<span class="sd">    &gt;&gt;&gt; dir_flux, pa  = vampolaPA(3000, alpha=range(0,181,2), order=4)</span>
<span class="sd">    &gt;&gt;&gt; dir_flux[:10], pa[:10]</span>
<span class="sd">    (array([  0.00000000e+00,   6.64032473e-04,   1.05986545e-02,</span>
<span class="sd">          5.34380898e-02,   1.67932162e-01,   4.06999226e-01,</span>
<span class="sd">          8.36427502e-01,   1.53325140e+00,   2.58383611e+00,</span>
<span class="sd">          4.08170975e+00]), [0, 2, 4, 6, 8, 10, 12, 14, 16, 18])</span>
<span class="sd">    &gt;&gt;&gt; omniFromDirectionalFlux(dir_flux, pa, norm=False)</span>
<span class="sd">    3000.0000008112293</span>
<span class="sd">    </span>
<span class="sd">    Calculate &quot;spin-averaged&quot; flux, giving answer per steradian</span>

<span class="sd">    &gt;&gt;&gt; omniFromDirectionalFlux(dir_flux, pa, norm=True)</span>
<span class="sd">    238.73241470239859</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">flen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fluxarr</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">fluxarr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fluxarr</span><span class="p">])</span>
        <span class="n">flen</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">flen</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="c1">#assume isotropy</span>
            <span class="k">return</span> <span class="n">fluxarr</span>
    <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
       <span class="n">fac</span> <span class="o">=</span> <span class="mi">1</span>
       <span class="n">denomina</span> <span class="o">=</span> <span class="n">integ</span><span class="o">.</span><span class="n">quad</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
       <span class="n">fac</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
       <span class="n">denomina</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">alphrad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">alphas</span><span class="p">)</span>
    <span class="n">numera</span> <span class="o">=</span> <span class="n">integ</span><span class="o">.</span><span class="n">simps</span><span class="p">(</span><span class="n">fluxarr</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alphrad</span><span class="p">),</span> <span class="n">alphrad</span><span class="p">)</span>
    <span class="n">omniflux</span> <span class="o">=</span> <span class="n">fac</span><span class="o">*</span><span class="n">numera</span><span class="o">/</span><span class="n">denomina</span>
    <span class="k">return</span> <span class="n">omniflux</span></div>


<div class="viewcode-block" id="getSolarRotation"><a class="viewcode-back" href="../../autosummary/spacepy.empiricals.getSolarRotation.html#spacepy.empiricals.getSolarRotation">[docs]</a><span class="k">def</span> <span class="nf">getSolarRotation</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">rtype</span><span class="o">=</span><span class="s1">&#39;carrington&#39;</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Calculates solar rotation number (Carrington or Bartels) for a given date/time</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    ticks : spacepy.time.Ticktock or datetime.datetime</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    rnumber : integer or array</span>
<span class="sd">        Carrington (or Bartels) rotation number</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">total_seconds</span><span class="p">(</span><span class="n">dobj</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">dobj</span><span class="o">.</span><span class="n">days</span><span class="o">*</span><span class="mi">24</span><span class="o">*</span><span class="mi">3600</span> <span class="o">+</span> <span class="n">dobj</span><span class="o">.</span><span class="n">seconds</span> <span class="o">+</span> <span class="n">dobj</span><span class="o">.</span><span class="n">microseconds</span><span class="o">/</span><span class="mf">1e6</span>
    <span class="k">if</span> <span class="n">rtype</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;carrington&#39;</span><span class="p">:</span>
        <span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1853</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">160000</span><span class="p">)</span>
        <span class="c1">#length = datetime.timedelta(days=27, minutes=396, seconds=25, microseconds=919999)</span>
        <span class="n">length</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mf">27.2753</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">rtype</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;bartels&#39;</span><span class="p">:</span>
        <span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1832</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">start_JD</span> <span class="o">=</span> <span class="n">spt</span><span class="o">.</span><span class="n">Ticktock</span><span class="p">(</span><span class="n">start_date</span><span class="p">)</span><span class="o">.</span><span class="n">JD</span>
        <span class="n">length</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Solar rotation type </span><span class="si">{0}</span><span class="s1"> not recognized: Must be either &quot;carrington&quot; or &quot;Bartels&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">rtype</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">reverse</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">nels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rotation</span> <span class="o">=</span> <span class="n">total_seconds</span><span class="p">(</span><span class="n">ticks</span><span class="o">-</span><span class="n">start_date</span><span class="p">)</span><span class="o">/</span><span class="n">total_seconds</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
                <span class="n">rotation</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">fp</span><span class="p">:</span>
                    <span class="n">rotation</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">rotation</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Unidentified problem with input time </span><span class="si">{0}</span><span class="s1"> in getSolarRotation&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ticks</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ticks</span><span class="p">,</span> <span class="n">spt</span><span class="o">.</span><span class="n">Ticktock</span><span class="p">):</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="p">[</span><span class="n">total_seconds</span><span class="p">(</span><span class="n">tt</span><span class="o">-</span><span class="n">start_date</span><span class="p">)</span><span class="o">/</span><span class="n">total_seconds</span><span class="p">(</span><span class="n">length</span><span class="p">)</span> <span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="n">ticks</span><span class="o">.</span><span class="n">UTC</span><span class="p">]</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">rotation</span> <span class="o">=</span> <span class="p">[</span><span class="n">total_seconds</span><span class="p">(</span><span class="n">tt</span><span class="o">-</span><span class="n">start_date</span><span class="p">)</span><span class="o">/</span><span class="n">total_seconds</span><span class="p">(</span><span class="n">length</span><span class="p">)</span> <span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="n">ticks</span><span class="p">]</span>
                <span class="n">rotation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Unidentified problem with input time </span><span class="si">{0}</span><span class="s1"> in getSolarRotation&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ticks</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">rotation</span> <span class="o">=</span> <span class="n">rotation</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rotation</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#for now just assume single input, non-iterable</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">length</span><span class="o">*</span><span class="p">(</span><span class="n">ticks</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">date</span> <span class="o">=</span> <span class="n">elapsed</span> <span class="o">+</span> <span class="n">start_date</span>
        <span class="k">return</span> <span class="n">date</span></div>

<div class="viewcode-block" id="getSolarProtonSpectra"><a class="viewcode-back" href="../../autosummary/spacepy.empiricals.getSolarProtonSpectra.html#spacepy.empiricals.getSolarProtonSpectra">[docs]</a><span class="k">def</span> <span class="nf">getSolarProtonSpectra</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="mf">3.20e7</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=-</span><span class="mf">0.96</span><span class="p">,</span> <span class="n">E0</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span> <span class="n">Emin</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">Emax</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns a SpaceData with energy and fluence spectra of solar particle events</span>

<span class="sd">    The formulation follows that of:</span>
<span class="sd">    Ellison and Ramaty ApJ 298: 400-408, 1985</span>
<span class="sd">    dJ/dE = K^{-\gamma}exp(-E/E0)</span>
<span class="sd">    </span>
<span class="sd">    and the defualt values are the 10/16/2003 SEP event of:</span>
<span class="sd">    Mewaldt, R. A., et al. (2005), J. Geophys. Res., 110, A09S18, doi:10.1029/2005JA011038.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ================</span>
<span class="sd">    norm : float</span>
<span class="sd">        Normilization factor for the intensity of the SEP event</span>
<span class="sd">    gamma : float</span>
<span class="sd">        Power law index</span>
<span class="sd">    E0 : float</span>
<span class="sd">        Expoential scaling factor</span>
<span class="sd">    Emin : float</span>
<span class="sd">        Minimum energy for fit</span>
<span class="sd">    Emax : float</span>
<span class="sd">        Maximum energy for fit</span>
<span class="sd">    nsteps : int</span>
<span class="sd">        The number of log spaced energy steps to return</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    data : dm.SpaceData</span>
<span class="sd">        SpaceData with the energy and fluence values</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">Emin</span><span class="p">,</span> <span class="n">Emax</span><span class="p">,</span> <span class="n">nsteps</span><span class="p">)</span>
    <span class="n">fluence</span> <span class="o">=</span> <span class="n">norm</span><span class="o">*</span><span class="n">E</span><span class="o">**</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">E</span><span class="o">/</span><span class="n">E0</span><span class="p">)</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">SpaceData</span><span class="p">()</span>
    <span class="n">ans</span><span class="p">[</span><span class="s1">&#39;Energy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">dmarray</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
    <span class="n">ans</span><span class="p">[</span><span class="s1">&#39;Energy&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;UNITS&#39;</span><span class="p">:</span><span class="s1">&#39;MeV&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;DESCRIPTION&#39;</span><span class="p">:</span><span class="s1">&#39;Particle energy per nucleon&#39;</span><span class="p">}</span>
    <span class="n">ans</span><span class="p">[</span><span class="s1">&#39;Fluence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dm</span><span class="o">.</span><span class="n">dmarray</span><span class="p">(</span><span class="n">fluence</span><span class="p">)</span>
    <span class="n">ans</span><span class="p">[</span><span class="s1">&#39;Fluence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;UNITS&#39;</span> <span class="p">:</span> <span class="s1">&#39;cm^{-2} sr^{-1} (MeV/nuc)^{-1}&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;DESCRIPTION&#39;</span><span class="p">:</span><span class="s1">&#39;Fluence spectra fir to the model&#39;</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">ans</span></div>


      
<span class="n">ShueMP</span> <span class="o">=</span> <span class="n">getMPstandoff</span>
<span class="n">get_plasma_pause</span> <span class="o">=</span> <span class="n">getPlasmaPause</span>
<span class="n">get_Lmax</span> <span class="o">=</span> <span class="n">getLmax</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="https://spacepy.github.io/"">homepage</a>|&nbsp;</li>
        <li><a href="https://github.com/spacepy/spacepy">development</a>|&nbsp;</li>
        <li><a href="../../search.html">search</a>|&nbsp;</li>
       <li><a href="../../index.html">documentation </a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../spacepy.html" >spacepy</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">spacepy.empiricals</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2011-2022, The SpacePy Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    </div>
  </body>
</html>