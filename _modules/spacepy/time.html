<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>spacepy.time &mdash; SpacePy v0.2.1 Manual</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/spacepy_favicon.ico"/>
    <link rel="top" title="SpacePy v0.2.1 Manual" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body role="document">

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../../index.html"><img src="../../_static/spacepy_logo.jpg" border="0" alt="spacepy_logo"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="https://github.com/spacepy/spacepy">homepage</a>|&nbsp;</li>
        <li><a href="../../search.html">search</a>|&nbsp;</li>
       <li><a href="../../index.html">documentation </a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for spacepy.time</h1><div class="highlight"><pre>
<span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Time conversion, manipulation and implementation of Ticktock class</span>


<span class="sd">Examples:</span>
<span class="sd">=========</span>

<span class="sd">&gt;&gt;&gt; import spacepy.time as spt</span>
<span class="sd">&gt;&gt;&gt; import datetime as dt</span>

<span class="sd">Day of year calculations</span>

<span class="sd">&gt;&gt;&gt; dts = spt.doy2date([2002]*4, range(186,190), dtobj=True)</span>
<span class="sd">&gt;&gt;&gt; dts</span>
<span class="sd">[datetime.datetime(2002, 7, 5, 0, 0),</span>
<span class="sd">datetime.datetime(2002, 7, 6, 0, 0),</span>
<span class="sd">datetime.datetime(2002, 7, 7, 0, 0),</span>
<span class="sd">datetime.datetime(2002, 7, 8, 0, 0)]</span>

<span class="sd">&gt;&gt;&gt; dts = spt.Ticktock(dts,&#39;UTC&#39;)</span>
<span class="sd">&gt;&gt;&gt; dts.DOY</span>
<span class="sd">array([ 186.,  187.,  188.,  189.])</span>

<span class="sd">Ticktock object creation</span>

<span class="sd">&gt;&gt;&gt; isodates = [&#39;2009-12-01T12:00:00&#39;, &#39;2009-12-04T00:00:00&#39;, &#39;2009-12-06T12:00:00&#39;]</span>
<span class="sd">&gt;&gt;&gt; dts = spt.Ticktock(isodates, &#39;ISO&#39;)</span>

<span class="sd">OR</span>

<span class="sd">&gt;&gt;&gt; dtdates = [dt.datetime(2009,12,1,12), dt.datetime(2009,12,4), dt.datetime(2009,12,6,12)]</span>
<span class="sd">&gt;&gt;&gt; dts = spt.Ticktock(dtdates, &#39;UTC&#39;)</span>

<span class="sd">ISO time formatting</span>

<span class="sd">&gt;&gt;&gt; dts = spt.tickrange(&#39;2009-12-01T12:00:00&#39;,&#39;2009-12-06T12:00:00&#39;,2.5)</span>

<span class="sd">OR</span>

<span class="sd">&gt;&gt;&gt; dts = spt.tickrange(dt.datetime(2009,12,1,12),dt.datetime(2009,12,6,12), \</span>
<span class="sd">    dt.timedelta(days=2, hours=12))</span>

<span class="sd">&gt;&gt;&gt; dts</span>
<span class="sd">Ticktock( [&#39;2009-12-01T12:00:00&#39;, &#39;2009-12-04T00:00:00&#39;, &#39;2009-12-06T12:00:00&#39;] ), dtype=ISO</span>

<span class="sd">&gt;&gt;&gt; dts.isoformat()</span>
<span class="sd">Current ISO output format is %Y-%m-%dT%H:%M:%S</span>
<span class="sd">Options are: [(&#39;seconds&#39;, &#39;%Y-%m-%dT%H:%M:%S&#39;), (&#39;microseconds&#39;, &#39;%Y-%m-%dT%H:%M:%S.%f&#39;)]</span>

<span class="sd">&gt;&gt;&gt; dts.isoformat(&#39;microseconds&#39;)</span>
<span class="sd">&gt;&gt;&gt; dts.ISO</span>
<span class="sd">[&#39;2009-12-01T12:00:00.000000&#39;,</span>
<span class="sd"> &#39;2009-12-04T00:00:00.000000&#39;,</span>
<span class="sd"> &#39;2009-12-06T12:00:00.000000&#39;]</span>

<span class="sd">Time manipulation</span>

<span class="sd">&gt;&gt;&gt; new_dts = dts + tdelt</span>
<span class="sd">&gt;&gt;&gt; new_dts.UTC</span>
<span class="sd">[datetime.datetime(2009, 12, 2, 18, 0),</span>
<span class="sd"> datetime.datetime(2009, 12, 5, 6, 0),</span>
<span class="sd"> datetime.datetime(2009, 12, 7, 18, 0)]</span>

<span class="sd">Other time formats</span>

<span class="sd">&gt;&gt;&gt; dts.RDT  # Gregorian ordinal time</span>
<span class="sd">array([ 733742.5,  733745. ,  733747.5])</span>

<span class="sd">&gt;&gt;&gt; dts.GPS # GPS time</span>
<span class="sd">array([  9.43704015e+08,   9.43920015e+08,   9.44136015e+08])</span>

<span class="sd">&gt;&gt;&gt; dts.JD # Julian day</span>
<span class="sd">array([ 2455167. ,  2455169.5,  2455172. ])</span>

<span class="sd">And so on.</span>

<span class="sd">.. currentmodule:: spacepy.time</span>

<span class="sd">.. NOTE... there is an error with this reference</span>

<span class="sd">Authors: Steve Morley, Josef Koller, Brian Larsen, Jon Niehof</span>
<span class="sd">Institution: Los Alamos National Laboratory</span>
<span class="sd">Contact: smorley@lanl.gov,</span>


<span class="sd">Copyright 2010 Los Alamos National Security, LLC.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">bisect</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">MutableSequence</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">MutableSequence</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">izip</span> <span class="k">as</span> <span class="nb">zip</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="k">pass</span>  <span class="c1"># just use system zip. In python3 itertools.izip is just python zip</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">dateutil.parser</span> <span class="kn">as</span> <span class="nn">dup</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">spacepy</span> <span class="kn">import</span> <span class="n">help</span>
<span class="kn">import</span> <span class="nn">spacepy.datamodel</span>

<span class="n">__contact__</span> <span class="o">=</span> <span class="s1">&#39;Steve Morley, smorley@lanl.gov&#39;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Notes:</span>
<span class="sd">Python&#39;s assert statement is a good way to catch situations that should never happen. And it can be removed by Python</span>
<span class="sd">optimization when the code is trusted to be correct. Assert is not to be used in program flow.</span>

<span class="sd">In Python, on the other hand, there is no strict distinction between debug and release mode. The interpreter features</span>
<span class="sd">an &quot;optimization flag&quot; (-O), but currently this does not actually optimize the byte code, but only removes asserts.</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="c1"># -----------------------------------------------</span>
<span class="c1"># Ticktock class</span>
<span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock">[docs]</a><span class="k">class</span> <span class="nc">Ticktock</span><span class="p">(</span><span class="n">MutableSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ticktock( data, dtype )</span>

<span class="sd">    Ticktock class holding various time coordinate systems</span>
<span class="sd">    (TAI, UTC, ISO, JD, MJD, UNX, RDT, CDF, DOY, eDOY)</span>

<span class="sd">    Possible input data types:</span>
<span class="sd">    ISO: ISO standard format like &#39;2002-02-25T12:20:30&#39;</span>
<span class="sd">    UTC: datetime object with UTC time</span>
<span class="sd">    TAI: elapsed seconds since 1958/1/1 (includes leap seconds)</span>
<span class="sd">    UNX: elapsed seconds since 1970/1/1 (all days have 86400 secs sometimes unequal lenghts)</span>
<span class="sd">    JD: Julian days elapsed</span>
<span class="sd">    MJD: Modified Julian days</span>
<span class="sd">    RDT: Rata Die days elapsed since 1/1/1</span>
<span class="sd">    CDF: CDF epoch: milliseconds since 1/1/0000</span>

<span class="sd">    Possible output data types:</span>
<span class="sd">    All those listed above, plus</span>
<span class="sd">    DOY:  Integer day of year, starts with day 1</span>
<span class="sd">    eDOY: Fractional day of year, starts at day 0</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    data : array_like (int, datetime, float, string)</span>
<span class="sd">        time stamp</span>
<span class="sd">    dtype : string {`CDF`, `ISO`, `UTC`, `TAI`, `UNX`, `JD`, `MJD`, `RDT`} or function</span>
<span class="sd">        data type for data, if a function it must convert input time format to Python datetime</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    out : Ticktock</span>
<span class="sd">        instance with self.data, self.dtype, self.UTC etc</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>
<span class="sd">    &gt;&gt;&gt; x = Ticktock([2452331.0142361112, 2452332.0142361112], &#39;JD&#39;)</span>
<span class="sd">    &gt;&gt;&gt; x.ISO</span>
<span class="sd">    dmarray([&#39;2002-02-25T12:20:30&#39;, &#39;2002-02-26T12:20:30&#39;], dtype=&#39;|S19&#39;)</span>
<span class="sd">    &gt;&gt;&gt; x.DOY # Day of year</span>
<span class="sd">    dmarray([ 56.,  57.])</span>
<span class="sd">    &gt;&gt;&gt; y = Ticktock([&#39;01-01-2013&#39;, &#39;20-03-2013&#39;], lambda x: datetime.datetime.strptime(x, &#39;%d-%m-%Y&#39;))</span>
<span class="sd">    &gt;&gt;&gt; y.UTC</span>
<span class="sd">    dmarray([2013-01-01 00:00:00, 2013-03-20 00:00:00], dtype=object)</span>
<span class="sd">    &gt;&gt;&gt; y.DOY # Day of year</span>
<span class="sd">    dmarray([  1.,  79.])</span>

<span class="sd">    .. autosummary::</span>
<span class="sd">        ~Ticktock.append</span>
<span class="sd">        ~Ticktock.argsort</span>
<span class="sd">        ~Ticktock.convert</span>
<span class="sd">        ~Ticktock.getCDF</span>
<span class="sd">        ~Ticktock.getDOY</span>
<span class="sd">        ~Ticktock.getGPS</span>
<span class="sd">        ~Ticktock.getISO</span>
<span class="sd">        ~Ticktock.getJD</span>
<span class="sd">        ~Ticktock.getMJD</span>
<span class="sd">        ~Ticktock.getRDT</span>
<span class="sd">        ~Ticktock.getTAI</span>
<span class="sd">        ~Ticktock.getUNX</span>
<span class="sd">        ~Ticktock.getUTC</span>
<span class="sd">        ~Ticktock.geteDOY</span>
<span class="sd">        ~Ticktock.getleapsecs</span>
<span class="sd">        ~Ticktock.isoformat</span>
<span class="sd">        ~Ticktock.now</span>
<span class="sd">        ~Ticktock.sort</span>
<span class="sd">        ~Ticktock.update_items</span>
<span class="sd">    .. automethod:: append</span>
<span class="sd">    .. automethod:: argsort</span>
<span class="sd">    .. automethod:: convert</span>
<span class="sd">    .. automethod:: getCDF</span>
<span class="sd">    .. automethod:: getDOY</span>
<span class="sd">    .. automethod:: getGPS</span>
<span class="sd">    .. automethod:: getISO</span>
<span class="sd">    .. automethod:: getJD</span>
<span class="sd">    .. automethod:: getMJD</span>
<span class="sd">    .. automethod:: getRDT</span>
<span class="sd">    .. automethod:: getTAI</span>
<span class="sd">    .. automethod:: getUNX</span>
<span class="sd">    .. automethod:: getUTC</span>
<span class="sd">    .. automethod:: geteDOY</span>
<span class="sd">    .. automethod:: getleapsecs</span>
<span class="sd">    .. automethod:: isoformat</span>
<span class="sd">    .. automethod:: now</span>
<span class="sd">    .. automethod:: sort</span>
<span class="sd">    .. automethod:: update_items</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_keylist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;UTC&#39;</span><span class="p">,</span> <span class="s1">&#39;TAI&#39;</span><span class="p">,</span> <span class="s1">&#39;ISO&#39;</span><span class="p">,</span> <span class="s1">&#39;JD&#39;</span><span class="p">,</span> <span class="s1">&#39;MJD&#39;</span><span class="p">,</span> <span class="s1">&#39;UNX&#39;</span><span class="p">,</span> <span class="s1">&#39;RDT&#39;</span><span class="p">,</span> <span class="s1">&#39;CDF&#39;</span><span class="p">,</span> <span class="s1">&#39;GPS&#39;</span><span class="p">,</span> <span class="s1">&#39;DOY&#39;</span><span class="p">,</span> <span class="s1">&#39;eDOY&#39;</span><span class="p">,</span> <span class="s1">&#39;leaps&#39;</span><span class="p">]</span>
    <span class="n">_keylist_upper</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">_keylist</span><span class="p">]</span>
    <span class="n">_isoformatstr</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;seconds&#39;</span><span class="p">:</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%S&#39;</span><span class="p">,</span> <span class="s1">&#39;microseconds&#39;</span><span class="p">:</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%S.</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_isofmt</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="o">.</span><span class="n">_isoformatstr</span><span class="p">[</span><span class="s1">&#39;seconds&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Ticktock</span><span class="p">):</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">spacepy</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span><span class="p">(</span><span class="n">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">spacepy</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span><span class="p">([</span><span class="n">data</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">spacepy</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">Callable</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;ISO&#39;</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
                    <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;UTC&#39;</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1e13</span><span class="p">:</span>
                    <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;CDF&#39;</span>
                <span class="k">elif</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unable to guess dtype from data; &#39;</span>
                                     <span class="s1">&#39;please specify dtype.&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">dtype</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">Ticktock</span><span class="o">.</span><span class="n">_keylist_upper</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;data type &quot;</span> <span class="o">+</span> <span class="n">dtype</span> <span class="o">+</span> <span class="s2">&quot; not provided, only &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Ticktock</span><span class="o">.</span><span class="n">_keylist</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># process input data using callable dtype to convert to datetime/UTC</span>
                <span class="n">dtype_func</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">dtype_func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span> <span class="o">=</span> <span class="n">no_tzinfo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dtype</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dtype_func</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dtype</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;ISO&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ISO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dtype</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;TAI&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">TAI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="k">elif</span> <span class="n">dtype</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;JD&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">JD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="k">elif</span> <span class="n">dtype</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;MJD&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">MJD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="k">elif</span> <span class="n">dtype</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;UNX&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">UNX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="k">elif</span> <span class="n">dtype</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;RDT&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">RDT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="k">elif</span> <span class="n">dtype</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;CDF&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">CDF</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="k">elif</span> <span class="n">dtype</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;UTC&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span> <span class="o">=</span> <span class="n">no_tzinfo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

            <span class="c1">## Brian and Steve were looking at this to see about making plot work directly on the object</span>
            <span class="c1">## is also making iterate as an array of datetimes</span>
            <span class="c1">#    def __iter__(self):</span>
            <span class="c1">#        i = 0</span>
            <span class="c1">#        try:</span>
            <span class="c1">#            while True:</span>
            <span class="c1">#                v = self[i].UTC[0]</span>
            <span class="c1">#                yield v</span>
            <span class="c1">#                i += 1</span>
            <span class="c1">#        except IndexError:</span>
            <span class="c1">#            return</span>

    <span class="c1"># -----------------------------------------------</span>
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.__str__() or a</span>

<span class="sd">        Will be called when printing Ticktock instance a</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">        out : string</span>
<span class="sd">            string representaion of the class</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:03&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Ticktock( [&#39;2002-02-02T12:00:00&#39;], dtype=ISO)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;Ticktock( &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, dtype=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>

    <span class="n">__repr__</span> <span class="o">=</span> <span class="n">__str__</span>

    <span class="c1"># -----------------------------------------------</span>
    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is called when pickling</span>
<span class="sd">        See Also http://docs.python.org/library/pickle.html</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">odict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># copy the dict since we change it</span>
        <span class="k">return</span> <span class="n">odict</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Is called when unpickling</span>
<span class="sd">        See Also http://docs.python.org/library/pickle.html</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># -----------------------------------------------</span>
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.__getitem__(idx) or a[idx]</span>

<span class="sd">        Will be called when requesting items in this instance</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        idx : int</span>
<span class="sd">            the item index to get</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">        out : Ticktock</span>
<span class="sd">            Ticktock instance with requested values</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:03&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a[0]</span>
<span class="sd">        &#39;2002-02-02T12:00:00&#39;</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        a.__setitem__</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Ticktock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>

    <span class="c1"># -----------------------------------------------</span>
    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">vals</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.__setitem__(idx, vals) or a[idx] = vals</span>

<span class="sd">        Will be called setting items in this instance</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        idx : int</span>
<span class="sd">            integer numbers as index</span>
<span class="sd">        vals: {float, string, datetime}</span>
<span class="sd">            new values</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:03&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a[0] = &#39;2003-03-03T00:00:00&#39;</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        a.__getitem__</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">])[:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>

    <span class="c1"># -----------------------------------------------</span>
    <span class="k">def</span> <span class="nf">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.__delitem(index)</span>

<span class="sd">        will be called when deleting items in the sequence</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>

    <span class="c1"># -----------------------------------------------</span>
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.__len__() or len(a)</span>

<span class="sd">        Will be called when requesting the length, i.e. number of items</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">        out : int</span>
<span class="sd">            length</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:03&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a.len</span>
<span class="sd">        1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># -----------------------------------------------</span>
    <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">UNX</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">UNX</span>

    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">UNX</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">UNX</span>

    <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">UNX</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">UNX</span>

    <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">UNX</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">UNX</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">UNX</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">UNX</span>

    <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">UNX</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">UNX</span>

    <span class="c1"># -----------------------------------------------</span>
    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.__sub__(other)</span>

<span class="sd">        Will be called if a timedelta object is subtracted from this instance and</span>
<span class="sd">        returns a new Ticktock instance. If a Ticktock is subtracted from another</span>
<span class="sd">        Ticktock then a list of timedeltas is returned.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        other : Ticktock or datetime.timedelta</span>
<span class="sd">            instance for comparison</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:00&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; dt = datetime.timedelta(3)</span>
<span class="sd">        &gt;&gt;&gt; a - dt</span>
<span class="sd">        Ticktock( [&#39;2002-02-05T12:00:00&#39;] ), dtype=ISO</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        __add__</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">):</span>
            <span class="n">newobj</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTC</span> <span class="o">-</span> <span class="n">other</span><span class="p">,</span> <span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Ticktock</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Ticktock lengths are mismatched, subtraction is not possible&#39;</span><span class="p">)</span>
            <span class="n">same</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">same</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">if</span> <span class="n">same</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">t</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">TAI</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TAI</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">t</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">TAI</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">TAI</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Data supplied for addition is of the wrong type&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Data supplied for addition is of the wrong shape&quot;</span><span class="p">)</span>
            <span class="n">same</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">same</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">if</span> <span class="n">same</span><span class="p">:</span>
                <span class="n">newUTC</span> <span class="o">=</span> <span class="p">[</span><span class="n">utc</span> <span class="o">-</span> <span class="n">o</span> <span class="k">for</span> <span class="n">utc</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">,</span> <span class="n">other</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">newUTC</span> <span class="o">=</span> <span class="p">[</span><span class="n">utc</span> <span class="o">-</span> <span class="n">other</span> <span class="k">for</span> <span class="n">utc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">]</span>
            <span class="n">newobj</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">newUTC</span><span class="p">,</span> <span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;unsupported operand type(s) for -: {0} and {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">newobj</span>

    <span class="c1"># -----------------------------------------------</span>
    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.__add__(other)</span>

<span class="sd">        Will be called if an iterable of datetime.timedeltas is added to this instance and</span>
<span class="sd">        returns a new Ticktock instance</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        other : datetime.timedelta</span>
<span class="sd">            instance for comparison</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:00&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; import datetime as dt</span>
<span class="sd">        &gt;&gt;&gt; delt = dt.timedelta(minutes=1)</span>
<span class="sd">        &gt;&gt;&gt; a + delt</span>
<span class="sd">        Ticktock( [&#39;2002-02-02T12:01:00&#39;] , dtype=ISO)</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        __sub__</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">):</span>
            <span class="n">newobj</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTC</span> <span class="o">+</span> <span class="n">other</span><span class="p">,</span> <span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Data supplied for addition is of the wrong type&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Data supplied for addition is of the wrong shape&quot;</span><span class="p">)</span>
            <span class="n">same</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">same</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">if</span> <span class="n">same</span><span class="p">:</span>
                <span class="n">newUTC</span> <span class="o">=</span> <span class="p">[</span><span class="n">utc</span> <span class="o">+</span> <span class="n">o</span> <span class="k">for</span> <span class="n">utc</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">,</span> <span class="n">other</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">newUTC</span> <span class="o">=</span> <span class="p">[</span><span class="n">utc</span> <span class="o">+</span> <span class="n">other</span> <span class="k">for</span> <span class="n">utc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">]</span>
            <span class="n">newobj</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">newUTC</span><span class="p">,</span> <span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;unsupported operand type(s) for +: {0} and {1}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">newobj</span>

    <span class="k">def</span> <span class="nf">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.__radd__(other)</span>

<span class="sd">        reverse add -- Will be called if this object is added to a datetime.timedelta and</span>
<span class="sd">        returns a new Ticktock instance</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        other : datetime.timedelta</span>
<span class="sd">            instance for comparison</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:00&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; import datetime as dt</span>
<span class="sd">        &gt;&gt;&gt; delt = dt.timedelta(minutes=1)</span>
<span class="sd">        &gt;&gt;&gt; a + delt</span>
<span class="sd">        Ticktock( [&#39;2002-02-02T12:01:00&#39;] , dtype=ISO)</span>


<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        __sub__</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="c1"># -----------------------------------------------</span>
    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.__getattr__(name)</span>

<span class="sd">        Will be called if attribute &quot;name&quot; is not found in Ticktock class instance.</span>
<span class="sd">        It will add TAI, RDT, etc</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">            name : string</span>
<span class="sd">                a string from the list of time systems</span>
<span class="sd">                    &#39;UTC&#39;, &#39;TAI&#39;, &#39;ISO&#39;, &#39;JD&#39;, &#39;MJD&#39;, &#39;UNX&#39;, &#39;RDT&#39;, &#39;CDF&#39;, &#39;DOY&#39;, &#39;eDOY&#39;, &#39;leaps&#39;</span>
<span class="sd">        Returns</span>
<span class="sd">        ========</span>
<span class="sd">            out: list, array</span>
<span class="sd">                requested values as either list/numpy array</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">Ticktock</span><span class="o">.</span><span class="n">_keylist</span><span class="p">,</span> <span class="s2">&quot;data type &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; not provided, only &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">Ticktock</span><span class="o">.</span><span class="n">_keylist</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;TAI&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">TAI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTAI</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;ISO&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ISO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getISO</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;JD&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">JD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getJD</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;MJD&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">MJD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMJD</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;UNX&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">UNX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUNX</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;RDT&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">RDT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRDT</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;CDF&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">CDF</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCDF</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;DOY&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">DOY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDOY</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;EDOY&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">eDOY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geteDOY</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;GPS&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">GPS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGPS</span><span class="p">()</span>
        <span class="c1"># if name == &#39;isoformat&#39;: self.__isofmt = self.isoformat()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;leaps&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getleapsecs</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="c1"># -----------------------------------------------</span>
    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        insert values into the TickTock object</span>

<span class="sd">        .. note:: If more than one value to insert a slice must be specified</span>
<span class="sd">        as the index.  See numpy.insert</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">            idx : int, slice or sequence of ints</span>
<span class="sd">                Object that defines the index or indices before which `val` is inserted.</span>
<span class="sd">            val : array_like</span>
<span class="sd">                values to insert</span>
<span class="sd">            dtype : str (optional)</span>
<span class="sd">                must be specified if not CDF, ISO, or UTC</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">dtype</span><span class="p">:</span>
            <span class="n">dum</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dum</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">ival</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">dum</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">ival</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>

    <span class="c1"># -----------------------------------------------</span>
    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.remove(idx)</span>

<span class="sd">        This will remove the Ticktock value at index idx</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.sort"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.sort">[docs]</a>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;quicksort&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.sort()</span>

<span class="sd">        This will sort the Ticktock values in place, if you need a stable sort use kind=&#39;mergesort&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">RDT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RDT</span>
        <span class="c1"># TODO does this not being stable matter? to make stable use kind=&#39;mergesort&#39;</span>
        <span class="n">RDTsorted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">RDT</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">)</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">RDTsorted</span><span class="p">,</span> <span class="s1">&#39;RDT&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
        <span class="k">return</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.argsort"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.argsort">[docs]</a>    <span class="k">def</span> <span class="nf">argsort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;mergesort&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        idx = a.argsort()</span>

<span class="sd">        This will return the indices that would sort the Ticktock values</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">        out : list</span>
<span class="sd">            indices that would sort the Ticktock values</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">RDT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RDT</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">RDT</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">idx</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.isoformat"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.isoformat">[docs]</a>    <span class="k">def</span> <span class="nf">isoformat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.update_items(b, attrib)</span>

<span class="sd">        This changes the self._isofmt attribute by and subsequently this</span>
<span class="sd">        function will update the ISO attribute.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        fmt : string, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fmt</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Current ISO output format is </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_isofmt</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Options are: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">([(</span><span class="n">k</span><span class="p">,</span> <span class="n">Ticktock</span><span class="o">.</span><span class="n">_isoformatstr</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">Ticktock</span><span class="o">.</span><span class="n">_isoformatstr</span><span class="o">.</span><span class="n">keys</span><span class="p">())]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_isofmt</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="o">.</span><span class="n">_isoformatstr</span><span class="p">[</span><span class="n">fmt</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Not a valid option: Use {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">Ticktock</span><span class="o">.</span><span class="n">_isoformatstr</span><span class="o">.</span><span class="n">keys</span><span class="p">()))))</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.update_items"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.update_items">[docs]</a>    <span class="k">def</span> <span class="nf">update_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls</span><span class="p">,</span> <span class="n">attrib</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.update_items(b, attrib)</span>

<span class="sd">        After changing the self.data attribute by either __setitem__ or __add__ etc</span>
<span class="sd">        this function will update all other attributes. This function is</span>
<span class="sd">        called automatically in __add__ and __setitem__</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        cls : Ticktock</span>
<span class="sd">        attrib : string</span>
<span class="sd">            attribute to update</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        spacepy.Ticktock.__setitem__</span>
<span class="sd">        spacepy.Ticktock.__add__</span>
<span class="sd">        spacepy.Ticktock.__sub__</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keylist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="c1"># keylist.remove(&#39;dtype&#39;)</span>
        <span class="n">keylist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">attrib</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">keylist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">attrib</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUTC</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keylist</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;TAI&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">TAI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTAI</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;ISO&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ISO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getISO</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;JD&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">JD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getJD</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;MJD&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">MJD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMJD</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;UNX&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">UNX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUNX</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;RDT&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">RDT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRDT</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;CDF&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">CDF</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCDF</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;DOY&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">DOY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDOY</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;eDOY&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">eDOY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geteDOY</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;GPS&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">GPS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGPS</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;leaps&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getleapsecs</span><span class="p">()</span>

        <span class="k">return</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.convert"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.convert">[docs]</a>    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.convert(dtype)</span>

<span class="sd">        convert a Ticktock instance into a new time coordinate system provided in dtype</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        dtype : string</span>
<span class="sd">            data type for new system, possible values are {`CDF`, `ISO`, `UTC`, `TAI`, `UNX`, `JD`, `MJD`, `RDT`}</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">        out : Ticktock</span>
<span class="sd">            Ticktock instance with new time coordinates</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock([&#39;2002-02-02T12:00:00&#39;, &#39;2002-02-02T12:00:00&#39;], &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; s = a.convert(&#39;TAI&#39;)</span>
<span class="sd">        &gt;&gt;&gt; type(s)</span>
<span class="sd">        &lt;class &#39;time.Ticktock&#39;&gt;</span>
<span class="sd">        &gt;&gt;&gt; s</span>
<span class="sd">        Ticktock( [1391342432 1391342432] ), dtype=TAI</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        CDF</span>
<span class="sd">        ISO</span>
<span class="sd">        UTC</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">newdat</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">newdat</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.append"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.append">[docs]</a>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.append(other)</span>

<span class="sd">        Will be called when another Ticktock instance has to be appended to the current one</span>

<span class="sd">        Parameters</span>
<span class="sd">        ==========</span>
<span class="sd">        other : Ticktock</span>
<span class="sd">            other (Ticktock instance)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">otherdata</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">otherdata</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">])</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.getCDF"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.getCDF">[docs]</a>    <span class="k">def</span> <span class="nf">getCDF</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.getCDF() or a.CDF</span>

<span class="sd">        Return CDF time which is milliseconds since 01-Jan-0000 00:00:00.000.</span>
<span class="sd">        &quot;Year zero&quot; is a convention chosen by NSSDC to measure epoch values.</span>
<span class="sd">        This date is more commonly referred to as 1 BC. Remember that 1 BC was a leap year.</span>
<span class="sd">        The CDF date/time calculations do not take into account the changes to the Gregorian</span>
<span class="sd">        calendar, and cannot be directly converted into Julian date/times.</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">        out : numpy array</span>
<span class="sd">            days elapsed since Jan. 1st</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:00&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a.CDF</span>
<span class="sd">        array([  6.31798704e+13])</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        getUTC</span>
<span class="sd">        getUNX</span>
<span class="sd">        getRDT</span>
<span class="sd">        getJD</span>
<span class="sd">        getMJD</span>
<span class="sd">        getISO</span>
<span class="sd">        getTAI</span>
<span class="sd">        getDOY</span>
<span class="sd">        geteDOY</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">RDTdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRDT</span><span class="p">()</span>
        <span class="n">CDF</span> <span class="o">=</span> <span class="n">RDTdata</span> <span class="o">*</span> <span class="mf">86400000.0</span> <span class="o">+</span> <span class="mf">86400000.0</span> <span class="o">*</span> <span class="mf">365.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CDF</span> <span class="o">=</span> <span class="n">CDF</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CDF</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.getDOY"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.getDOY">[docs]</a>    <span class="k">def</span> <span class="nf">getDOY</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.DOY or a.getDOY()</span>

<span class="sd">        extract DOY (days since January 1st of given year)</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">        out : numpy array</span>
<span class="sd">            day of the year</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:00&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a.DOY</span>
<span class="sd">        array([ 33])</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        getUTC</span>
<span class="sd">        getUNX</span>
<span class="sd">        getRDT</span>
<span class="sd">        getJD</span>
<span class="sd">        getMJD</span>
<span class="sd">        getISO</span>
<span class="sd">        getTAI</span>
<span class="sd">        getDOY</span>
<span class="sd">        geteDOY</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">DOY</span> <span class="o">=</span> <span class="p">[</span><span class="n">utc</span><span class="o">.</span><span class="n">toordinal</span><span class="p">()</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="n">utc</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">toordinal</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">utc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DOY</span> <span class="o">=</span> <span class="n">spacepy</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span><span class="p">(</span><span class="n">DOY</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;DOY&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DOY</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.geteDOY"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.geteDOY">[docs]</a>    <span class="k">def</span> <span class="nf">geteDOY</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.eDOY or a.geteDOY()</span>

<span class="sd">        extract eDOY (elapsed days since midnight January 1st of given year)</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">        out : numpy array</span>
<span class="sd">            days elapsed since midnight bbedJan. 1st</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:00&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a.eDOY</span>
<span class="sd">        array([ 32.5])</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        getUTC</span>
<span class="sd">        getUNX</span>
<span class="sd">        getRDT</span>
<span class="sd">        getJD</span>
<span class="sd">        getMJD</span>
<span class="sd">        getISO</span>
<span class="sd">        getTAI</span>
<span class="sd">        getDOY</span>
<span class="sd">        geteDOY</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">eDOY</span> <span class="o">=</span> <span class="p">[</span><span class="n">utc</span><span class="o">.</span><span class="n">toordinal</span><span class="p">()</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="n">utc</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">toordinal</span><span class="p">()</span> <span class="k">for</span> <span class="n">utc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">]</span>
        <span class="n">eDOY</span> <span class="o">=</span> <span class="p">[</span><span class="n">edoy</span> <span class="o">+</span> <span class="n">utc</span><span class="o">.</span><span class="n">hour</span> <span class="o">/</span> <span class="mf">24.</span> <span class="o">+</span> <span class="n">utc</span><span class="o">.</span><span class="n">minute</span> <span class="o">/</span> <span class="mf">1440.</span> <span class="o">+</span> <span class="n">utc</span><span class="o">.</span><span class="n">second</span> <span class="o">/</span> <span class="mf">86400.</span> <span class="o">+</span> <span class="n">utc</span><span class="o">.</span><span class="n">microsecond</span> <span class="o">/</span> <span class="mf">86400000000.</span>
                <span class="k">for</span> <span class="n">edoy</span><span class="p">,</span> <span class="n">utc</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">eDOY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eDOY</span> <span class="o">=</span> <span class="n">spacepy</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span><span class="p">(</span><span class="n">eDOY</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;eDOY&#39;</span><span class="p">})</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eDOY</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.getJD"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.getJD">[docs]</a>    <span class="k">def</span> <span class="nf">getJD</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.JD or a.getJD()</span>

<span class="sd">        convert dtype data into Julian Date (JD)</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">        out : numpy array</span>
<span class="sd">            elapsed days since 12:00 January 1, 4713 BC</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:00&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a.JD</span>
<span class="sd">        array([ 2452308.])</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        getUTC</span>
<span class="sd">        getUNX</span>
<span class="sd">        getRDT</span>
<span class="sd">        getJD</span>
<span class="sd">        getMJD</span>
<span class="sd">        getISO</span>
<span class="sd">        getTAI</span>
<span class="sd">        getDOY</span>
<span class="sd">        geteDOY</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">decimal</span>

        <span class="n">nTAI</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># convert all types in to UTC first and call again</span>
        <span class="n">UTCdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span>

        <span class="k">if</span> <span class="n">UTCdata</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1582</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Calendar date before the switch from Julian to Gregorian</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
                          <span class="s2">&quot;    Calendar 1582-Oct-15: Use Julian Calendar dates as input&quot;</span><span class="p">)</span>

        <span class="c1"># include offset if given</span>
        <span class="n">JD</span> <span class="o">=</span> <span class="n">spacepy</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nTAI</span><span class="p">),</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;JD&#39;</span><span class="p">})</span>

        <span class="n">twelve</span><span class="p">,</span> <span class="n">twofour</span><span class="p">,</span> <span class="n">mind</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;12.0&#39;</span><span class="p">),</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;24.0&#39;</span><span class="p">),</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;1440.0&#39;</span><span class="p">)</span>
        <span class="n">sind</span><span class="p">,</span> <span class="n">usind</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;86400.0&#39;</span><span class="p">),</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s1">&#39;86400000000.0&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nTAI</span><span class="p">):</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="n">UTCdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">offset</span><span class="p">:</span>
                <span class="n">UTCdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">UTCdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">offset</span>

            <span class="c1"># extract year, month, day</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">UTCdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
            <span class="n">M</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">UTCdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
            <span class="n">D</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">UTCdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">day</span><span class="p">)</span>

            <span class="c1"># the following is from Wikipedia (but is wrong by 2 days)</span>
            <span class="c1"># JDN = D-32075+1461*(Y+4800+(M-14)/12)/4+367*(M-2-(M-14)/12*12)/12-3*((Y+4900+(M-14)/12)/100)/4</span>
            <span class="c1"># JD = JDN + (data.hour-12)/24. + data.minute/1440. + data.second/86400.</span>

            <span class="c1"># following Press, &quot;Numerical Recipes&quot;, Fct: JULDAY, p. 10</span>
            <span class="n">igreg</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">+</span> <span class="mi">31</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">*</span> <span class="mi">1582</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">M</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">JY</span> <span class="o">=</span> <span class="n">Y</span>
                <span class="n">JM</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">JY</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">JM</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">13</span>
            <span class="n">JD</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">365.25</span> <span class="o">*</span> <span class="n">JY</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="mf">30.6001</span> <span class="o">*</span> <span class="n">JM</span><span class="p">)</span> <span class="o">+</span> <span class="n">D</span> <span class="o">+</span> <span class="mi">1720995</span>
            <span class="n">c_val</span> <span class="o">=</span> <span class="p">(</span><span class="n">D</span> <span class="o">+</span> <span class="mi">31</span> <span class="o">*</span> <span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">*</span> <span class="n">Y</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">c_val</span> <span class="o">&gt;=</span> <span class="n">igreg</span><span class="p">:</span>  <span class="c1"># yes if date after the Gregorian Switch in 1582-Oct-15</span>
                <span class="n">JA</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.01</span> <span class="o">*</span> <span class="n">JY</span><span class="p">)</span>
                <span class="n">JD</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">JD</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">JA</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">JA</span><span class="p">)</span>

            <span class="c1"># add this to num.recipes to get fractional days</span>
            <span class="c1"># twelve, twofour, mind = decimal.Decimal(&#39;12.0&#39;), decimal.Decimal(&#39;24.0&#39;), decimal.Decimal(&#39;1440.0&#39;)</span>
            <span class="c1"># sind, usind = decimal.Decimal(&#39;86400.0&#39;), decimal.Decimal(&#39;86400000000.0&#39;)</span>
            <span class="n">JD</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">JD</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">+</span> <span class="p">(</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">UTCdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">hour</span><span class="p">))</span> <span class="o">-</span> <span class="n">twelve</span><span class="p">)</span> <span class="o">/</span> <span class="n">twofour</span> <span class="o">+</span> \
                    <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">UTCdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">minute</span> <span class="o">/</span> <span class="mf">1440.</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">UTCdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">second</span><span class="p">))</span> <span class="o">/</span> <span class="n">sind</span><span class="p">)</span> <span class="o">+</span> \
                    <span class="p">(</span><span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">UTCdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">microsecond</span><span class="p">))</span> <span class="o">/</span> <span class="n">usind</span><span class="p">)</span>
            <span class="n">JD</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">JD</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="c1"># JD[i] = JD[i] + (UTCdata[i].hour-12)/24. + UTCdata[i].minute/1440. + \</span>
            <span class="c1"># UTCdata[i].second/86400. + UTCdata[i].microsecond/86400000000.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">JD</span> <span class="o">=</span> <span class="n">JD</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">JD</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.getMJD"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.getMJD">[docs]</a>    <span class="k">def</span> <span class="nf">getMJD</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.MJD or a.getMJD()</span>

<span class="sd">        convert dtype data into MJD (modified Julian date)</span>

<span class="sd">        Returns</span>
<span class="sd">        ========</span>
<span class="sd">        out : numpy array</span>
<span class="sd">            elapsed days since November 17, 1858 (Julian date was 2,400 000)</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:00&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a.MJD</span>
<span class="sd">        array([ 52307.5])</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        getUTC, getUNX, getRDT, getJD, getISO, getCDF, getTAI, getDOY, geteDOY</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1582</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;WARNING: Calendar date before the switch from Julian to Gregorian</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
                          <span class="s2">&quot;Calendar 1582-Oct-15: Use Julian Calendar dates as input&quot;</span><span class="p">)</span>

        <span class="n">MJD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JD</span> <span class="o">-</span> <span class="mf">2400000.5</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">MJD</span> <span class="o">=</span> <span class="n">MJD</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">MJD</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.getUNX"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.getUNX">[docs]</a>    <span class="k">def</span> <span class="nf">getUNX</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.UNX or a.getUNX()</span>

<span class="sd">        convert dtype data into Unix Time (Posix Time)</span>
<span class="sd">        seconds since 1970-Jan-1 (not counting leap seconds)</span>

<span class="sd">        Returns</span>
<span class="sd">        ========</span>
<span class="sd">        out : numpy array</span>
<span class="sd">            elapsed secs since 1970/1/1 (not counting leap secs)</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:00&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a.UNX</span>
<span class="sd">        array([  1.01265120e+09])</span>

<span class="sd">        See Also</span>
<span class="sd">        =========</span>
<span class="sd">        getUTC, getISO, getRDT, getJD, getMJD, getCDF, getTAI, getDOY, geteDOY</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">UNX0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1970</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">[</span><span class="n">utc</span> <span class="o">-</span> <span class="n">UNX0</span> <span class="k">for</span> <span class="n">utc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">]</span>
        <span class="n">UNX</span> <span class="o">=</span> <span class="p">[</span><span class="n">dd</span><span class="o">.</span><span class="n">days</span> <span class="o">*</span> <span class="mi">86400</span> <span class="o">+</span> <span class="n">dd</span><span class="o">.</span><span class="n">seconds</span> <span class="o">+</span> <span class="n">dd</span><span class="o">.</span><span class="n">microseconds</span> <span class="o">/</span> <span class="mf">1.e6</span> <span class="k">for</span> <span class="n">dd</span> <span class="ow">in</span> <span class="n">d</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">UNX</span> <span class="o">=</span> <span class="n">spacepy</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span><span class="p">(</span><span class="n">UNX</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;UNX&#39;</span><span class="p">})</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">UNX</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.getRDT"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.getRDT">[docs]</a>    <span class="k">def</span> <span class="nf">getRDT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.RDT or a.RDT()</span>

<span class="sd">        convert dtype data into Rata Die (lat.) Time (days since 1/1/0001)</span>

<span class="sd">        Returns</span>
<span class="sd">        ========</span>
<span class="sd">        out : numpy array</span>
<span class="sd">            elapsed days since 1/1/1</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:00&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a.RDT</span>
<span class="sd">        array([ 730883.5])</span>

<span class="sd">        See Also</span>
<span class="sd">        =========</span>
<span class="sd">        getUTC, getUNX, getISO, getJD, getMJD, getCDF, getTAI, getDOY, geteDOY</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">matplotlib.dates</span> <span class="kn">import</span> <span class="n">date2num</span>

        <span class="c1"># This is how to do this without date2num</span>
        <span class="c1"># nTAI = len(self.data)</span>
        <span class="c1"># RDT = np.zeros(nTAI)</span>
        <span class="c1"># for i in np.arange(nTAI):</span>
        <span class="c1"># RDT[i] = UTC[i].toordinal() + UTC[i].hour/24. + UTC[i].minute/1440. + \</span>
        <span class="c1"># UTC[i].second/86400. + UTC[i].microsecond/86400000000.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">RDT</span> <span class="o">=</span> <span class="n">spacepy</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span><span class="p">(</span><span class="n">date2num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">),</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;RDT&#39;</span><span class="p">})</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">RDT</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.getUTC"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.getUTC">[docs]</a>    <span class="k">def</span> <span class="nf">getUTC</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.UTC or a.getUTC()</span>

<span class="sd">        convert dtype data into UTC object a la datetime()</span>

<span class="sd">        Returns</span>
<span class="sd">        ========</span>
<span class="sd">        out : list of datetime objects</span>
<span class="sd">            datetime object in UTC time</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:00&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a.UTC</span>
<span class="sd">        [datetime.datetime(2002, 2, 2, 12, 0)]</span>

<span class="sd">        See Also</span>
<span class="sd">        =========</span>
<span class="sd">        getISO, getUNX, getRDT, getJD, getMJD, getCDF, getTAI, getDOY, geteDOY</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">matplotlib.dates</span> <span class="kn">import</span> <span class="n">num2date</span>

        <span class="n">nTAI</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># if already UTC, we are done, no conversion</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;UTC&#39;</span><span class="p">:</span>
            <span class="n">UTC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;ISO&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ISO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="c1"># try a few special cases that are faster than dateutil.parser</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">UTC</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">isot</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%S&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">isot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">UTC</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">isot</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%SZ&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">isot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">UTC</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">isot</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">isot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">UTC</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">isot</span><span class="p">,</span> <span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">isot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">UTC</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">isot</span><span class="p">,</span> <span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">isot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
                            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                                <span class="n">UTC</span> <span class="o">=</span> <span class="p">[</span><span class="n">dup</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">isot</span><span class="p">)</span> <span class="k">for</span> <span class="n">isot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;TAI&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TAI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="n">TAI0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1958</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">UTC</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">tait</span><span class="p">))</span> <span class="o">+</span> <span class="n">TAI0</span> <span class="k">for</span> <span class="n">tait</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
            <span class="c1"># add leap seconds after UTC is created</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span> <span class="o">=</span> <span class="n">UTC</span>
            <span class="n">leapsecs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getleapsecs</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nTAI</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">UTC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">leapsecs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">tmpleaps</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">leaps</span>
                <span class="k">if</span> <span class="n">tmpleaps</span> <span class="o">==</span> <span class="n">leapsecs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;GPS&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GPS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="n">GPS0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1980</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">UTC</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">gpst</span><span class="p">))</span> <span class="o">+</span> <span class="n">GPS0</span> <span class="k">for</span> <span class="n">gpst</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
            <span class="c1"># add leap seconds after UTC is created</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span> <span class="o">=</span> <span class="n">UTC</span>
            <span class="n">leapsecs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getleapsecs</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nTAI</span><span class="p">):</span>
                <span class="c1"># there were 18 leap seconds before gps zero, need the -18 for that</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">UTC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">leapsecs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">+</span> \
                              <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;UNX&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">UNX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="n">UNX0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1970</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">UTC</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">unxt</span><span class="p">)</span> <span class="o">+</span> <span class="n">UNX0</span> <span class="k">for</span> <span class="n">unxt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;RDT&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RDT</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="n">UTC</span> <span class="o">=</span> <span class="n">num2date</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">UTC</span> <span class="o">=</span> <span class="n">no_tzinfo</span><span class="p">(</span><span class="n">UTC</span><span class="p">)</span>
            <span class="c1"># for i in np.arange(nTAI):</span>
            <span class="c1"># UTC[i] = datetime.datetime(1,1,1) + \</span>
            <span class="c1"># datetime.timedelta(days=np.floor(self.data[i])-1) +  \</span>
            <span class="c1"># datetime.timedelta(microseconds=(self.data[i] - \</span>
            <span class="c1"># self.data[i])*86400000.)</span>
            <span class="c1"># roundoff the microseconds</span>
            <span class="c1"># UTC[i] = UTC[i] - datetime.timedelta(microseconds=UTC[i].microsecond)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;CDF&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CDF</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="n">UTC</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">cdft</span> <span class="o">/</span> <span class="mf">86400000.</span><span class="p">)</span> <span class="o">+</span>
                   <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">366</span><span class="p">)</span> <span class="k">for</span> <span class="n">cdft</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
            <span class="c1"># UTC[i] = datetime.timedelta(days=np.floor(self.data[i]/86400000.), \</span>
            <span class="c1"># milliseconds=np.mod(self.data[i],86400000)) + \</span>
            <span class="c1"># datetime.datetime(1,1,1) - datetime.timedelta(days=366)</span>
            <span class="c1"># the following has round off errors</span>
            <span class="c1"># UTC[i] = datetime.timedelta(data[i]/86400000.-366) + datetime.datetime(1,1,1)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;JD&#39;</span><span class="p">,</span> <span class="s1">&#39;MJD&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;MJD&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">JD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="mf">2400000.5</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">MJD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">JD</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
            <span class="n">UTC</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">nTAI</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nTAI</span><span class="p">):</span>
                <span class="c1"># extract partial days</span>
                <span class="n">ja</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JD</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JD</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">JD</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c1"># after Press: &quot;Numerical Recipes&quot;</span>
                <span class="c1"># http://www.rgagnon.com/javadetails/java-0506.html</span>
                <span class="c1"># only good for after 15-Oct-1582</span>
                <span class="n">igreg</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">+</span> <span class="mi">31</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">*</span> <span class="mi">1582</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ja</span> <span class="o">&gt;=</span> <span class="n">igreg</span><span class="p">:</span>  <span class="c1"># after switching to Gregorian Calendar</span>
                    <span class="n">jalpha</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(((</span><span class="n">ja</span> <span class="o">-</span> <span class="mi">1867216</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.25</span><span class="p">)</span> <span class="o">/</span> <span class="mf">36524.25</span><span class="p">)</span>
                    <span class="n">ja</span> <span class="o">=</span> <span class="n">ja</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">jalpha</span> <span class="o">-</span> <span class="n">jalpha</span> <span class="o">//</span> <span class="mi">4</span>

                <span class="n">jb</span> <span class="o">=</span> <span class="n">ja</span> <span class="o">+</span> <span class="mi">1524</span>
                <span class="n">jc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">6680.0</span> <span class="o">+</span> <span class="p">((</span><span class="n">jb</span> <span class="o">-</span> <span class="mi">2439870</span><span class="p">)</span> <span class="o">-</span> <span class="mf">122.1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">365.25</span><span class="p">)</span>
                <span class="n">jd</span> <span class="o">=</span> <span class="mi">365</span> <span class="o">*</span> <span class="n">jc</span> <span class="o">+</span> <span class="n">jc</span> <span class="o">//</span> <span class="mi">4</span>
                <span class="n">je</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">jb</span> <span class="o">-</span> <span class="n">jd</span><span class="p">)</span> <span class="o">/</span> <span class="mf">30.6001</span><span class="p">)</span>
                <span class="n">day</span> <span class="o">=</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jd</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="mf">30.6001</span> <span class="o">*</span> <span class="n">je</span><span class="p">)</span>
                <span class="n">month</span> <span class="o">=</span> <span class="n">je</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">month</span> <span class="o">&gt;</span> <span class="mi">12</span><span class="p">):</span> <span class="n">month</span> <span class="o">=</span> <span class="n">month</span> <span class="o">-</span> <span class="mi">12</span>
                <span class="n">year</span> <span class="o">=</span> <span class="n">jc</span> <span class="o">-</span> <span class="mi">4715</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">month</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">):</span> <span class="n">year</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">year</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">):</span> <span class="n">year</span> <span class="o">=</span> <span class="n">year</span> <span class="o">-</span> <span class="mi">1</span>

                <span class="c1"># after http://aa.usno.navy.mil/faq/docs/JD_Formula.php</span>
                <span class="c1"># also good only for after 1582-Oct-15</span>
                <span class="c1"># L= JD+68569</span>
                <span class="c1"># N= 4*L/146097</span>
                <span class="c1"># = L-(146097*N+3)/4</span>
                <span class="c1"># I= 4000*(L+1)/1461001</span>
                <span class="c1"># L= L-1461*I/4+31</span>
                <span class="c1"># J= 80*L/2447</span>
                <span class="c1"># K= L-2447*J/80</span>
                <span class="c1"># L= J/11</span>
                <span class="c1"># J= J+2-12*L</span>
                <span class="c1"># I= 100*(N-49)+I+L</span>

                <span class="n">UTC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">day</span><span class="p">))</span> <span class="o">+</span> \
                         <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="o">+</span> \
                         <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">p</span> <span class="o">*</span> <span class="mi">86400</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">UTC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1582</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">):</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;WARNING: Calendar date before the switch from Julian to Gregorian</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
                                  <span class="s2">&quot;Calendar 1582-Oct-15: Use Julian Calendar dates as input&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">warnstr1</span> <span class="o">=</span> <span class="s1">&#39;Input data type {0} does not support calculation of UTC times&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">])</span>
            <span class="n">warnstr2</span> <span class="o">=</span> <span class="s1">&#39;Valid input dtypes are: {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">kk</span> <span class="k">for</span> <span class="n">kk</span> <span class="ow">in</span> <span class="n">Ticktock</span><span class="o">.</span><span class="n">_keylist</span> <span class="k">if</span> <span class="n">kk</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DOY&#39;</span><span class="p">,</span> <span class="s1">&#39;eDOY&#39;</span><span class="p">,</span> <span class="s1">&#39;leaps&#39;</span><span class="p">]]))</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;{0}</span><span class="se">\n</span><span class="s1">{1}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">warnstr1</span><span class="p">,</span> <span class="n">warnstr2</span><span class="p">))</span>

        <span class="n">UTC</span> <span class="o">=</span> <span class="n">spacepy</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span><span class="p">(</span><span class="n">UTC</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;UTC&#39;</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span> <span class="o">=</span> <span class="n">no_tzinfo</span><span class="p">(</span><span class="n">UTC</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">no_tzinfo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">)</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.getGPS"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.getGPS">[docs]</a>    <span class="k">def</span> <span class="nf">getGPS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.GPS or a.getGPS()</span>

<span class="sd">        return GPS epoch (0000 UT (midnight) on January 6, 1980)</span>

<span class="sd">        Returns</span>
<span class="sd">        ========</span>
<span class="sd">            out : numpy array</span>
<span class="sd">                elapsed secs since 6Jan1980 (excludes leap secs)</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:00&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a.GPS</span>
<span class="sd">        array([])</span>

<span class="sd">        See Also</span>
<span class="sd">        =========</span>
<span class="sd">        getUTC, getUNX, getRDT, getJD, getMJD, getCDF, getISO, getDOY, geteDOY</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">GPS0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1980</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">leapsec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getleapsecs</span><span class="p">()</span>

        <span class="n">GPStup</span> <span class="o">=</span> <span class="p">[</span><span class="n">utc</span> <span class="o">-</span> <span class="n">GPS0</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">ls</span><span class="p">))</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>
                  <span class="k">for</span> <span class="n">utc</span><span class="p">,</span> <span class="n">ls</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">,</span> <span class="n">leapsec</span><span class="p">)]</span>
        <span class="n">GPS</span> <span class="o">=</span> <span class="p">[</span><span class="n">gps</span><span class="o">.</span><span class="n">days</span> <span class="o">*</span> <span class="mi">86400</span> <span class="o">+</span> <span class="n">gps</span><span class="o">.</span><span class="n">seconds</span> <span class="o">+</span> <span class="n">gps</span><span class="o">.</span><span class="n">microseconds</span> <span class="o">/</span> <span class="mf">1.e6</span> <span class="k">for</span> <span class="n">gps</span> <span class="ow">in</span> <span class="n">GPStup</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GPS</span> <span class="o">=</span> <span class="n">spacepy</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span><span class="p">(</span><span class="n">GPS</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;GPS&#39;</span><span class="p">})</span>  <span class="c1"># .astype(int)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">GPS</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.getTAI"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.getTAI">[docs]</a>    <span class="k">def</span> <span class="nf">getTAI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.TAI or a.getTAI()</span>

<span class="sd">        return TAI (International Atomic Time)</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">        out : numpy array</span>
<span class="sd">            elapsed secs since 1958/1/1 (includes leap secs, i.e. all secs have equal lengths)</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:00&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a.TAI</span>
<span class="sd">        array([1391342432])</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        getUTC, getUNX, getRDT, getJD, getMJD, getCDF, getISO, getDOY, geteDOY</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">TAI0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1958</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">leapsec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getleapsecs</span><span class="p">()</span>
        <span class="n">TAItup</span> <span class="o">=</span> <span class="p">[</span><span class="n">utc</span> <span class="o">-</span> <span class="n">TAI0</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">ls</span><span class="p">))</span> <span class="k">for</span> <span class="n">utc</span><span class="p">,</span> <span class="n">ls</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">,</span> <span class="n">leapsec</span><span class="p">)]</span>
        <span class="n">TAI</span> <span class="o">=</span> <span class="p">[</span><span class="n">tai</span><span class="o">.</span><span class="n">days</span> <span class="o">*</span> <span class="mi">86400</span> <span class="o">+</span> <span class="n">tai</span><span class="o">.</span><span class="n">seconds</span> <span class="o">+</span> <span class="n">tai</span><span class="o">.</span><span class="n">microseconds</span> <span class="o">/</span> <span class="mf">1.e6</span> <span class="k">for</span> <span class="n">tai</span> <span class="ow">in</span> <span class="n">TAItup</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">TAI</span> <span class="o">=</span> <span class="n">spacepy</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span><span class="p">(</span><span class="n">TAI</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;TAI&#39;</span><span class="p">})</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">TAI</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.getISO"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.getISO">[docs]</a>    <span class="k">def</span> <span class="nf">getISO</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.ISO or a.getISO()</span>

<span class="sd">        convert dtype data into ISO string</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">        out : list of strings</span>
<span class="sd">            date in ISO format</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:00&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a.ISO</span>
<span class="sd">        dmarray([&#39;2002-02-02T12:00:00&#39;])</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        getUTC, getUNX, getRDT, getJD, getMJD, getCDF, getTAI, getDOY, geteDOY</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nTAI</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TAI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTAI</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ISO</span> <span class="o">=</span> <span class="n">spacepy</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span><span class="p">([</span><span class="n">utc</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_isofmt</span><span class="p">)</span> <span class="k">for</span> <span class="n">utc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">],</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;ISO&#39;</span><span class="p">})</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nTAI</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">TAI</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">TAIleaps</span><span class="p">:</span>
                <span class="n">tmptick</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">tmptick</span><span class="o">.</span><span class="n">ISO</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
                <span class="n">cnew</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;59&#39;</span><span class="p">,</span> <span class="s1">&#39;60&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ISO</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="n">cnew</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ISO</span></div>

    <span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="Ticktock.getleapsecs"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.getleapsecs">[docs]</a>    <span class="k">def</span> <span class="nf">getleapsecs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        a.leaps or a.getleapsecs()</span>

<span class="sd">        retrieve leapseconds from lookup table, used in getTAI</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">        out : numpy array</span>
<span class="sd">            leap seconds</span>

<span class="sd">        Examples</span>
<span class="sd">        ========</span>
<span class="sd">        &gt;&gt;&gt; a = Ticktock(&#39;2002-02-02T12:00:00&#39;, &#39;ISO&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a.leaps</span>
<span class="sd">        array([32])</span>

<span class="sd">        See Also</span>
<span class="sd">        =========</span>
<span class="sd">        getTAI</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">spacepy</span> <span class="kn">import</span> <span class="n">DOT_FLN</span>

        <span class="n">tup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">UTC</span>
        <span class="c1"># so you don&#39;t have to read the file every single time</span>
        <span class="k">global</span> <span class="n">secs</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">TAIleaps</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">leaps</span> <span class="o">=</span> <span class="n">secs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">except</span><span class="p">:</span>  <span class="c1"># then we are calling this routine the 1st time</span>
            <span class="c1"># load current file</span>
            <span class="n">fname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DOT_FLN</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;tai-utc.dat&#39;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

            <span class="n">secs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
            <span class="n">year</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
            <span class="n">mon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
            <span class="n">day</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>

            <span class="n">months</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;JAN&#39;</span><span class="p">,</span> <span class="s1">&#39;FEB&#39;</span><span class="p">,</span> <span class="s1">&#39;MAR&#39;</span><span class="p">,</span> <span class="s1">&#39;APR&#39;</span><span class="p">,</span> <span class="s1">&#39;MAY&#39;</span><span class="p">,</span> <span class="s1">&#39;JUN&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;JUL&#39;</span><span class="p">,</span> <span class="s1">&#39;AUG&#39;</span><span class="p">,</span> <span class="s1">&#39;SEP&#39;</span><span class="p">,</span> <span class="s1">&#39;OCT&#39;</span><span class="p">,</span> <span class="s1">&#39;NOV&#39;</span><span class="p">,</span> <span class="s1">&#39;DEC&#39;</span><span class="p">])</span>

            <span class="k">for</span> <span class="n">line</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">secs</span><span class="p">))):</span>
                <span class="n">secs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">6</span><span class="p">]))</span>  <span class="c1"># truncate float seconds</span>
                <span class="n">year</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">mon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">months</span> <span class="o">==</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">day</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>

            <span class="n">TAIleaps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">secs</span><span class="p">))</span>
            <span class="n">TAItup</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">secs</span><span class="p">)</span>
            <span class="n">TAI0</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1958</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">secs</span><span class="p">)):</span>
                <span class="n">TAItup</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">mon</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">day</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">-</span> <span class="n">TAI0</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span>
                    <span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">secs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">TAIleaps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">TAItup</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">days</span> <span class="o">*</span> <span class="mi">86400</span> <span class="o">+</span> <span class="n">TAItup</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">seconds</span> <span class="o">+</span> <span class="n">TAItup</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">microseconds</span> <span class="o">/</span> <span class="mf">1.e6</span>

        <span class="c1"># check if array:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>  <span class="c1"># not an array of objects</span>
            <span class="n">tup</span> <span class="o">=</span> <span class="p">[</span><span class="n">tup</span><span class="p">]</span>
            <span class="n">nTAI</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">aflag</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nTAI</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span>
            <span class="n">aflag</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="c1"># convert them into a time tuple and find the correct leap seconds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TAIleaps</span> <span class="o">=</span> <span class="n">TAIleaps</span>
        <span class="n">leaps</span> <span class="o">=</span> <span class="p">[</span><span class="n">secs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">nTAI</span>
        <span class="n">leap_dates</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">))</span> <span class="k">for</span>
                      <span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">mon</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">secs</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">itup</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tup</span><span class="p">):</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect_right</span><span class="p">(</span><span class="n">leap_dates</span><span class="p">,</span> <span class="n">tup</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">leaps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">secs</span><span class="p">[</span><span class="n">ind</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

        <span class="c1">## ldatetime = datetime.datetime # avoid an expensive lookup below</span>
        <span class="c1">## for i, itup in enumerate(tup):</span>
        <span class="c1">##     for y,m,d,s in zip(year, mon, day, secs):</span>
        <span class="c1">##         if tup[i] &gt;= ldatetime(int(y),int(m),int(d)):</span>
        <span class="c1">##             leaps[i] = s</span>
        <span class="c1">##         else:</span>
        <span class="c1">##             break</span>

        <span class="c1"># if datetime.datetime(1971,12,31) &gt; tup[0]:</span>
        <span class="c1">#   print &quot;WARNING: date before 1972/1/1; leap seconds are by fractions off&quot;</span>

        <span class="k">if</span> <span class="n">aflag</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">leaps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">leaps</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">leaps</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># if you want to allow fractional leap seconds, remove &#39;int&#39; here</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">leaps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">leaps</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaps</span></div>

    <span class="c1"># -----------------------------------------------</span>
    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Ticktock.now"><a class="viewcode-back" href="../../autosummary/spacepy.time.Ticktock.html#spacepy.time.Ticktock.now">[docs]</a>    <span class="k">def</span> <span class="nf">now</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a Ticktock object with the current time, equivalent to datetime.now()</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">            out : ticktock</span>
<span class="sd">                Ticktock object with the current time, equivalent to datetime.now()</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        datetime.datetime.now</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="s1">&#39;UTC&#39;</span><span class="p">)</span></div>

    <span class="c1"># -----------------------------------------------</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">today</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a Ticktock object with the current date and time set to 00:00:00, equivalent to date.today() with time</span>
<span class="sd">        included</span>

<span class="sd">        Returns</span>
<span class="sd">        =======</span>
<span class="sd">            out : ticktock</span>
<span class="sd">                Ticktock object with the current time, equivalent to date.today() with time included</span>

<span class="sd">        See Also</span>
<span class="sd">        ========</span>
<span class="sd">        datetime.date.today()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">hour</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">minute</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">microsecond</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="s1">&#39;UTC&#39;</span><span class="p">)</span></div>


<span class="c1"># -----------------------------------------------</span>
<span class="c1"># End of Ticktock class</span>
<span class="c1"># -----------------------------------------------</span>

<div class="viewcode-block" id="doy2date"><a class="viewcode-back" href="../../autosummary/spacepy.time.doy2date.html#spacepy.time.doy2date">[docs]</a><span class="k">def</span> <span class="nf">doy2date</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">doy</span><span class="p">,</span> <span class="n">dtobj</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">flAns</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    convert integer day-of-year doy into a month and day</span>
<span class="sd">    after http://pleac.sourceforge.net/pleac_python/datesandtimes.html</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    year : int or array of int</span>
<span class="sd">        year</span>
<span class="sd">    doy : int or array of int</span>
<span class="sd">        day of year</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    month : int or array of int</span>
<span class="sd">        month as integer number</span>
<span class="sd">    day : int or array of int</span>
<span class="sd">        as integer number</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>
<span class="sd">    &gt;&gt;&gt; month, day = doy2date(2002, 186)</span>
<span class="sd">    &gt;&gt;&gt; dts = doy2date([2002]*4, range(186,190), dtobj=True)</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>
<span class="sd">    Ticktock.getDOY</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">n_year</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">n_year</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># Special case: this is a scalar</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">n_doy</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">doy</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">n_doy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">n_doy</span> <span class="o">!=</span> <span class="n">n_year</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Day of year and year must have same length&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">n_year</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">doy</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Day-of-Year less than 1 detected: DOY starts from 1&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">flAns</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> \
                 <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">doy</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> \
                 <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">doy</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dtobj</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dt</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">day</span>

    <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">doy</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Day-of-Year less than 1 detected: DOY starts from 1&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">flAns</span><span class="p">:</span>
        <span class="n">dateobj</span> <span class="o">=</span> <span class="n">spacepy</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span><span class="p">([</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
                                             <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">doy</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                                             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_year</span><span class="p">)])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dateobj</span> <span class="o">=</span> <span class="n">spacepy</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span><span class="p">([</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
                                             <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">doy</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                                             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_year</span><span class="p">)])</span>
    <span class="k">if</span> <span class="n">dtobj</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dateobj</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">spacepy</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span><span class="p">([</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">dateobj</span><span class="p">]),</span>
                <span class="n">spacepy</span><span class="o">.</span><span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span><span class="p">([</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">dateobj</span><span class="p">]))</span></div>


<span class="c1"># -----------------------------------------------</span>
<div class="viewcode-block" id="tickrange"><a class="viewcode-back" href="../../autosummary/spacepy.time.tickrange.html#spacepy.time.tickrange">[docs]</a><span class="k">def</span> <span class="nf">tickrange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">deltadays</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    return a Ticktock range given the start, end, and delta</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    start : string or number</span>
<span class="sd">        start time (ISO standard string and UTC/datetime do not require a dtype)</span>
<span class="sd">    end : string or number</span>
<span class="sd">        last possible time in series (excluded unless end=start+n*step for integer n)</span>
<span class="sd">    deltadays : float or timedelta</span>
<span class="sd">        step in units of days (float); or datetime timedelta object</span>
<span class="sd">    dtype : string (optional)</span>
<span class="sd">        data type for start, end; e.g. ISO, UTC, RTD, etc. see Ticktock for all options</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    out : Ticktock instance</span>
<span class="sd">        ticks</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>
<span class="sd">    &gt;&gt;&gt; ticks = st.tickrange(&#39;2002-02-01T00:00:00&#39;, &#39;2002-02-10T00:00:00&#39;, deltadays = 1)</span>
<span class="sd">    &gt;&gt;&gt; ticks</span>
<span class="sd">    Ticktock( [&#39;2002-02-01T00:00:00&#39;, &#39;2002-02-02T00:00:00&#39;, &#39;2002-02-03T00:00:00&#39;,</span>
<span class="sd">    &#39;2002-02-04T00:00:00&#39;] , dtype=ISO)</span>

<span class="sd">    See Also</span>
<span class="sd">    ========</span>
<span class="sd">    Ticktock</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Tstart</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
    <span class="n">Tend</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">end</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">Tend</span><span class="o">.</span><span class="n">UTC</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">Tstart</span><span class="o">.</span><span class="n">UTC</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dmusec</span><span class="p">,</span> <span class="n">dsec</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">microseconds</span> <span class="o">/</span> <span class="mf">86400000000.</span><span class="p">,</span> <span class="n">diff</span><span class="o">.</span><span class="n">seconds</span> <span class="o">/</span> <span class="mf">86400.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">deltadays</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">):</span>
        <span class="n">musec</span><span class="p">,</span> <span class="n">sec</span> <span class="o">=</span> <span class="n">deltadays</span><span class="o">.</span><span class="n">microseconds</span> <span class="o">/</span> <span class="mf">86400000000.</span><span class="p">,</span> <span class="n">deltadays</span><span class="o">.</span><span class="n">seconds</span> <span class="o">/</span> <span class="mf">86400.</span>
        <span class="n">deltat</span> <span class="o">=</span> <span class="n">musec</span> <span class="o">+</span> <span class="n">sec</span> <span class="o">+</span> <span class="n">deltadays</span><span class="o">.</span><span class="n">days</span>
        <span class="n">nticks</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">dmusec</span> <span class="o">+</span> <span class="n">dsec</span> <span class="o">+</span> <span class="n">diff</span><span class="o">.</span><span class="n">days</span><span class="p">)</span> <span class="o">/</span> <span class="n">deltat</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">trange</span> <span class="o">=</span> <span class="p">[</span><span class="n">Tstart</span><span class="o">.</span><span class="n">UTC</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">deltadays</span> <span class="o">*</span> <span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nticks</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nticks</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">dmusec</span> <span class="o">+</span> <span class="n">dsec</span> <span class="o">+</span> <span class="n">diff</span><span class="o">.</span><span class="n">days</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">deltadays</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">trange</span> <span class="o">=</span> <span class="p">[</span><span class="n">Tstart</span><span class="o">.</span><span class="n">UTC</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">deltadays</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nticks</span><span class="p">)]</span>
    <span class="n">ticks</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">(</span><span class="n">trange</span><span class="p">,</span> <span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ticks</span></div>


<div class="viewcode-block" id="sec2hms"><a class="viewcode-back" href="../../autosummary/spacepy.time.sec2hms.html#spacepy.time.sec2hms">[docs]</a><span class="k">def</span> <span class="nf">sec2hms</span><span class="p">(</span><span class="n">sec</span><span class="p">,</span> <span class="n">rounding</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">days</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">dtobj</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert seconds of day to hours, minutes, seconds</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    sec : float</span>
<span class="sd">        Seconds of day</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ================</span>
<span class="sd">    rounding : boolean</span>
<span class="sd">        set for integer seconds</span>
<span class="sd">    days : boolean</span>
<span class="sd">        set to wrap around day (i.e. modulo 86400)</span>
<span class="sd">    dtobj : boolean</span>
<span class="sd">        set to return a timedelta object</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    out : [hours, minutes, seconds] or datetime.timedelta</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">rounding</span><span class="p">:</span>
        <span class="n">sec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">sec</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">days</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">sec</span> <span class="o">&gt;</span> <span class="mi">86400</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Number of seconds &gt; seconds in day. &quot;</span>
                          <span class="s2">&quot;Try days keyword.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sec</span> <span class="o">%=</span> <span class="mi">86400</span>
    <span class="k">if</span> <span class="n">dtobj</span><span class="p">:</span>  <span class="c1"># no need to do the computation</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">sec</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hours</span> <span class="o">=</span> <span class="n">sec</span> <span class="o">//</span> <span class="mi">3600</span>
        <span class="n">minutes</span> <span class="o">=</span> <span class="p">((</span><span class="n">sec</span> <span class="o">-</span> <span class="n">hours</span> <span class="o">*</span> <span class="mi">3600</span><span class="p">)</span> <span class="o">//</span> <span class="mi">60</span><span class="p">)</span> <span class="o">%</span> <span class="mi">60</span>
        <span class="n">seconds</span> <span class="o">=</span> <span class="n">sec</span> <span class="o">%</span> <span class="mi">60</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">hours</span><span class="p">,</span> <span class="n">minutes</span><span class="p">,</span> <span class="n">seconds</span><span class="p">]</span></div>


<span class="k">def</span> <span class="nf">no_tzinfo</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    take in an arraylike of datetime objects and return them without any tzinfo</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    dt : iterable</span>
<span class="sd">        iterable of datetime.datetime objects</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    out : list</span>
<span class="sd">        list of datetime.datetime without tzinfo</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">returnclass</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">__class__</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">dt</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  <span class="c1"># was not an iterable, assume datetime</span>
        <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
    <span class="c1">#special case: numpy ndarray - dmarray and masked array work, but not ndarray</span>
    <span class="k">if</span> <span class="n">returnclass</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">returnclass</span><span class="p">(</span><span class="n">retval</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">retval</span><span class="p">)</span>


<div class="viewcode-block" id="leapyear"><a class="viewcode-back" href="../../autosummary/spacepy.time.leapyear.html#spacepy.time.leapyear">[docs]</a><span class="k">def</span> <span class="nf">leapyear</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">numdays</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    return an array of boolean leap year,</span>
<span class="sd">    a lot faster than the mod method that is normally seen</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    year : array_like</span>
<span class="sd">        array of years</span>
<span class="sd">    numdays : boolean (optional)</span>
<span class="sd">        optionally return the number of days in the year</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    out : numpy array</span>
<span class="sd">        an array of boolean leap year, or array of number of days</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>
<span class="sd">    &gt;&gt;&gt; import numpy</span>
<span class="sd">    &gt;&gt;&gt; import spacepy.time</span>
<span class="sd">    &gt;&gt;&gt; spacepy.time.leapyear(numpy.arange(15)+1998)</span>
<span class="sd">    [False, False,  True, False, False, False,  True, False, False,</span>
<span class="sd">          False,  True, False, False, False,  True]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">year</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
    <span class="n">mask400</span> <span class="o">=</span> <span class="p">(</span><span class="n">year</span> <span class="o">%</span> <span class="mi">400</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="n">mask100</span> <span class="o">=</span> <span class="p">(</span><span class="n">year</span> <span class="o">%</span> <span class="mi">100</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="n">mask4</span> <span class="o">=</span> <span class="p">(</span><span class="n">year</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="n">isleap</span> <span class="o">=</span> <span class="p">(</span><span class="n">mask400</span> <span class="o">|</span> <span class="n">mask4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">mask100</span> <span class="o">|</span> <span class="n">mask400</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">numdays</span><span class="p">:</span>
        <span class="n">isleap</span> <span class="o">=</span> <span class="n">isleap</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">+</span> <span class="mi">365</span>
    <span class="k">return</span> <span class="n">isleap</span></div>


<div class="viewcode-block" id="randomDate"><a class="viewcode-back" href="../../autosummary/spacepy.time.randomDate.html#spacepy.time.randomDate">[docs]</a><span class="k">def</span> <span class="nf">randomDate</span><span class="p">(</span><span class="n">dt1</span><span class="p">,</span> <span class="n">dt2</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="nb">sorted</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a (or many) random datetimes between two given dates, this is done under the convention dt &lt;=1 rand &lt; dt2</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    dt1 : datetime.datetime</span>
<span class="sd">        start date for the the random date</span>
<span class="sd">    dt2 : datetime.datetime</span>
<span class="sd">        stop date for the the random date</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ================</span>
<span class="sd">    N : int (optional)</span>
<span class="sd">        the number of random dates to generate (defualt=1)</span>
<span class="sd">    tzinfo : bool (optional)</span>
<span class="sd">        maintain the tzinfo of the input datetimes (default=False)</span>
<span class="sd">    sorted : bool (optional)</span>
<span class="sd">        return the times sorted (default=False)</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    out : datetime.datetime or numpy.ndarray of datetime.datetime</span>
<span class="sd">        the new time for the next call to EventTimer</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">matplotlib.dates</span> <span class="kn">import</span> <span class="n">date2num</span><span class="p">,</span> <span class="n">num2date</span>

    <span class="k">if</span> <span class="n">dt1</span><span class="o">.</span><span class="n">tzinfo</span> <span class="o">!=</span> <span class="n">dt2</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">:</span>
        <span class="k">raise</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;tzinfo for the input and output datetimes must match&#39;</span><span class="p">))</span>
    <span class="n">dt1n</span> <span class="o">=</span> <span class="n">date2num</span><span class="p">(</span><span class="n">dt1</span><span class="p">)</span>
    <span class="n">dt2n</span> <span class="o">=</span> <span class="n">date2num</span><span class="p">(</span><span class="n">dt2</span><span class="p">)</span>
    <span class="n">rnd_tn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">dt1n</span><span class="p">,</span> <span class="n">dt2n</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
    <span class="n">rnd_t</span> <span class="o">=</span> <span class="n">num2date</span><span class="p">(</span><span class="n">rnd_tn</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">tzinfo</span><span class="p">:</span>
        <span class="n">tzinfo</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tzinfo</span> <span class="o">=</span> <span class="n">dt1</span><span class="o">.</span><span class="n">tzinfo</span>
    <span class="n">rnd_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">val</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="n">tzinfo</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">rnd_t</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">sorted</span><span class="p">:</span>
        <span class="n">rnd_t</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">rnd_t</span></div>


<span class="k">def</span> <span class="nf">extract_YYYYMMDD</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    go through a string and extract the first valid YYYYMMDD as a datetime</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    filename : str</span>
<span class="sd">        string to parse for a YYYYMMDD format</span>

<span class="sd">    Returns</span>
<span class="sd">    =======</span>
<span class="sd">    out : (None, datetime.datetime)</span>
<span class="sd">        the datetime found in the string or None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># return a datetime if there is one from YYYYMMDD</span>
    <span class="c1"># be picky so don&#39;t match random numbers (1950-2049)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">r&quot;(19[5-9]|20[0-4])\d(0\d|1[0-2])([0-2]\d|3[01])&quot;</span><span class="p">,</span>
                  <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">m</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(),</span> <span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">valid_YYYYMMDD</span><span class="p">(</span><span class="n">inval</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    if inval is valid YYYYMMDD return True, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">r&quot;(19[5-9]|20[0-4])\d(0\d|1[0-2])([0-2]\d|3[01])&quot;</span><span class="p">,</span>
                 <span class="n">inval</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="https://github.com/spacepy/spacepy">homepage</a>|&nbsp;</li>
        <li><a href="../../search.html">search</a>|&nbsp;</li>
       <li><a href="../../index.html">documentation </a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2011-2019, The SpacePy Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
  </body>
</html>