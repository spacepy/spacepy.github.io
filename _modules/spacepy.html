
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>spacepy &#8212; SpacePy v0.4.0 Manual</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/default.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/copybutton.js"></script>
    
    <link rel="shortcut icon" href="../_static/spacepy_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../index.html"><img src="../_static/spacepy_logo.jpg" border="0" alt="spacepy_logo"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="https://spacepy.github.io/"">homepage</a>|&nbsp;</li>
        <li><a href="https://github.com/spacepy/spacepy">development</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
       <li><a href="../index.html">documentation </a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">spacepy</a></li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for spacepy</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="sd">&quot;&quot;&quot;SpacePy: Space Science Tools for Python</span>

<span class="sd">SpacePy is a package of tools primarily aimed at the space science community.</span>
<span class="sd">This __init__.py file sets the parameters for import statements.</span>

<span class="sd">If running the ipython shell, simply type &#39;?&#39; after any command for help.</span>
<span class="sd">ipython also offers tab completion, so hitting tab after &#39;&lt;module name&gt;.&#39;</span>
<span class="sd">will list all available functions, classes and variables.</span>

<span class="sd">Detailed HTML documentation is available online by typing:</span>

<span class="sd">    &gt;&gt;&gt; spacepy.help()</span>

<span class="sd">Most functionality is in spacepy&#39;s submodules. Each module has specific</span>
<span class="sd">help available:</span>

<span class="sd">.. rubric:: Submodules</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :template: clean_module.rst</span>

<span class="sd">    ~spacepy.coordinates</span>
<span class="sd">    ~spacepy.data_assimilation</span>
<span class="sd">    ~spacepy.datamodel</span>
<span class="sd">    ~spacepy.empiricals</span>
<span class="sd">    ~spacepy.irbempy</span>
<span class="sd">    ~spacepy.LANLstar</span>
<span class="sd">    ~spacepy.omni</span>
<span class="sd">    ~spacepy.poppy</span>
<span class="sd">    ~spacepy.pybats</span>
<span class="sd">    ~spacepy.pycdf</span>
<span class="sd">    ~spacepy.radbelt</span>
<span class="sd">    ~spacepy.seapy</span>
<span class="sd">    ~spacepy.time</span>
<span class="sd">    ~spacepy.toolbox</span>
<span class="sd">    ~spacepy.ae9ap9</span>

<span class="sd">.. rubric:: Functions</span>

<span class="sd">.. autosummary::</span>

<span class="sd">    deprecated</span>
<span class="sd">    help</span>

<span class="sd">.. autofunction:: deprecated</span>
<span class="sd">.. autofunction:: help</span>

<span class="sd">Copyright 2010-2016 Los Alamos National Security, LLC.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">ConfigParser</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">configparser</span> <span class="k">as</span> <span class="nn">ConfigParser</span>
<span class="kn">import</span> <span class="nn">errno</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>


<div class="viewcode-block" id="help"><a class="viewcode-back" href="../spacepy.html#spacepy.help">[docs]</a><span class="k">def</span> <span class="nf">help</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Launches web browser with SpacePy documentation</span>

<span class="sd">    Online help is always for the latest release of SpacePy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Opening docs for latest release. Installed SpacePy is </span><span class="si">{}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">__version__</span><span class="p">))</span>
    <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://spacepy.github.io/&#39;</span><span class="p">)</span></div>


<span class="c1"># put modules here that you want to be accessible through &#39;from spacepy import *&#39;</span>
<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;seapy&quot;</span><span class="p">,</span> <span class="s2">&quot;toolbox&quot;</span><span class="p">,</span> <span class="s2">&quot;poppy&quot;</span><span class="p">,</span> <span class="s2">&quot;coordinates&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;omni&quot;</span><span class="p">,</span> 
           <span class="s2">&quot;irbempy&quot;</span><span class="p">,</span> <span class="s2">&quot;empiricals&quot;</span><span class="p">,</span> <span class="s2">&quot;radbelt&quot;</span><span class="p">,</span> <span class="s2">&quot;data_assimilation&quot;</span><span class="p">,</span> <span class="s2">&quot;pycdf&quot;</span><span class="p">,</span>
           <span class="s2">&quot;datamanager&quot;</span><span class="p">,</span> <span class="s2">&quot;datamodel&quot;</span><span class="p">,</span> <span class="s2">&quot;ae9ap9&quot;</span><span class="p">]</span>

<span class="c1"># on windows, make sure the mingw runtime libs are findable</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">:</span>
    <span class="n">minglibs</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;mingw&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;PATH&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">minglibs</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PATH&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PATH&#39;</span><span class="p">]:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PATH&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;;&#39;</span> <span class="o">+</span> <span class="n">minglibs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1">#empth PATH</span>
                <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">minglibs</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">minglibs</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">add_dll_directory</span><span class="p">(</span><span class="n">minglibs</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># Python 3.8+ only</span>
        <span class="k">pass</span>

<span class="c1">#actual deprecation decorator</span>
<span class="k">def</span> <span class="nf">_deprecator</span><span class="p">(</span><span class="n">version</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">docstring</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
    <span class="c1">#this is the actual, deprecated function</span>
    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_deprecated</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">func</span><span class="o">.</span><span class="vm">__doc__</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">doclines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">doclines</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1"># Docstring SHOULD be a single non-blank line with summary, blank line,</span>
    <span class="c1"># and then the rest of the content. Want to put the deprecation</span>
    <span class="c1"># information just before the first line of &quot;rest of content&quot;</span>
    <span class="n">isblank</span> <span class="o">=</span> <span class="p">[</span><span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">doclines</span><span class="p">]</span>
    <span class="c1"># All places with a non-blank line following a blank</span>
    <span class="n">paragraphs</span> <span class="o">=</span>  <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">isblank</span><span class="p">))</span>
                   <span class="k">if</span> <span class="ow">not</span> <span class="n">isblank</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span>
                   <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">isblank</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">paragraphs</span><span class="p">:</span> <span class="c1"># No non-blank, guess indentation, insert at end</span>
        <span class="n">leading</span> <span class="o">=</span> <span class="s1">&#39;    &#39;</span>
        <span class="n">insert_at</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">doclines</span><span class="p">)</span> <span class="c1">#insert at end</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">paragraphs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># Get indent from only para, insert at end</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">doclines</span><span class="p">[</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">leading</span> <span class="o">=</span> <span class="n">l</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())]</span>
        <span class="n">insert_at</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">doclines</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># Get indent from 2nd paragraph, insert just before it</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">doclines</span><span class="p">[</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">leading</span> <span class="o">=</span> <span class="n">l</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())]</span>
        <span class="c1"># Insert before blank line before the paragraph.</span>
        <span class="n">insert_at</span> <span class="o">=</span> <span class="n">paragraphs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">to_insert</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="n">leading</span> <span class="o">+</span> <span class="s1">&#39;.. deprecated:: &#39;</span> <span class="o">+</span> <span class="n">version</span><span class="p">,</span>
    <span class="p">]</span> \
    <span class="o">+</span> <span class="p">[</span><span class="n">leading</span> <span class="o">+</span> <span class="s1">&#39;   &#39;</span> <span class="o">+</span> <span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">docstring</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)]</span>
    <span class="n">doclines</span><span class="p">[</span><span class="n">insert_at</span><span class="p">:</span><span class="n">insert_at</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_insert</span>
    <span class="n">_deprecated</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">doclines</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_deprecated</span>

<div class="viewcode-block" id="deprecated"><a class="viewcode-back" href="../spacepy.html#spacepy.deprecated">[docs]</a><span class="k">def</span> <span class="nf">deprecated</span><span class="p">(</span><span class="n">version</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">docstring</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Decorator to deprecate a function/method</span>

<span class="sd">    Modifies a function so that calls to it raise</span>
<span class="sd">    ``DeprecationWarning`` and the docstring has a deprecation</span>
<span class="sd">    note added in accordance with `numpydoc format</span>
<span class="sd">    &lt;https://numpydoc.readthedocs.io/en/latest/format.html#sections&gt;`_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ==========</span>
<span class="sd">    version : str</span>
<span class="sd">        What is the first version where this was deprecated?</span>

<span class="sd">    message : str</span>
<span class="sd">        Message to include in the deprecation warning and in the</span>
<span class="sd">        docstring.</span>

<span class="sd">    Other Parameters</span>
<span class="sd">    ================</span>
<span class="sd">    docstring : str</span>

<span class="sd">        .. versionadded:: 0.2.2</span>

<span class="sd">        If specified, ``docstring`` will be added to the modified function&#39;s</span>
<span class="sd">        docstring instead of ``message`` (which will only be used in the</span>
<span class="sd">        deprecation warning.) It can be a multi-line string (separated with</span>
<span class="sd">        ``\\n``). It will be indented to match the existing docstring.</span>

<span class="sd">    Notes</span>
<span class="sd">    =====</span>
<span class="sd">    On Python 2, the deprecated function&#39;s signature won&#39;t be preserved.</span>
<span class="sd">    The function will work but will not have proper argument names listed</span>
<span class="sd">    in e.g. ``help``.</span>

<span class="sd">    This warning will show as coming from SpacePy, not the deprecated</span>
<span class="sd">    function.</span>

<span class="sd">    Examples</span>
<span class="sd">    ========</span>
<span class="sd">        &gt;&gt;&gt; import spacepy</span>
<span class="sd">        &gt;&gt;&gt; @spacepy.deprecated(&#39;0.2.1&#39;, &#39;Use a different function instead&#39;,</span>
<span class="sd">        ...                     docstring=&#39;A different function is better\\n&#39;</span>
<span class="sd">        ...                               &#39;because of reasons xyz&#39;)</span>
<span class="sd">        ... def foo(x):</span>
<span class="sd">        ...     &#39;&#39;&#39;This is a test function</span>
<span class="sd">        ...</span>
<span class="sd">        ...     It may do many useful things.</span>
<span class="sd">        ...     &#39;&#39;&#39;</span>
<span class="sd">        ...     return x + 1</span>
<span class="sd">        &gt;&gt;&gt; help(foo)</span>
<span class="sd">        Help on function foo in module __main__:</span>
<span class="sd">        foo(x)</span>
<span class="sd">            This is a test function</span>
<span class="sd">            .. deprecated:: 0.2.1</span>
<span class="sd">               A different function is better</span>
<span class="sd">               because of reasons xyz</span>
<span class="sd">            It may do many useful things.</span>
<span class="sd">        &gt;&gt;&gt; foo(2)</span>
<span class="sd">        DeprecationWarning: Use a different function instead</span>
<span class="sd">        3</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">message</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="n">version</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">version</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">docstring</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">docstring</span> <span class="o">=</span> <span class="n">message</span>
    <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">_deprecator</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">docstring</span><span class="p">)</span></div>

<span class="c1"># Expose definitions from modules in this package.</span>
<span class="c1"># since datamodel depends on top level, delay the variable binding</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">datamodel</span>
<span class="n">dmarray</span> <span class="o">=</span> <span class="n">datamodel</span><span class="o">.</span><span class="n">dmarray</span>
<span class="n">SpaceData</span> <span class="o">=</span> <span class="n">datamodel</span><span class="o">.</span><span class="n">SpaceData</span>

<span class="c1">#package info</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;0.4.0&#39;</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;The SpacePy Team&#39;</span>
<span class="n">__team__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Steve Morley&#39;</span><span class="p">,</span> <span class="s1">&#39;Josef Koller&#39;</span><span class="p">,</span> <span class="s1">&#39;Dan Welling&#39;</span><span class="p">,</span> <span class="s1">&#39;Brian Larsen&#39;</span><span class="p">,</span> <span class="s1">&#39;Jon Niehof&#39;</span><span class="p">,</span> <span class="s1">&#39;Mike Henderson&#39;</span><span class="p">]</span>
<span class="n">__contact__</span> <span class="o">=</span> <span class="s1">&#39;spacepy@lanl.gov&#39;</span>
<span class="n">__license__</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;SpacePy: Space Science Tools for Python</span>


<span class="s2">Copyright 2010 Triad National Security, LLC.</span>
<span class="s2">All Rights Reserved.</span>

<span class="s2">This is open source software; you can redistribute it and/or modify it under the </span>
<span class="s2">terms of the Python Software Foundation License. If software is modified to</span>
<span class="s2">produce derivative works, such modified software should be clearly marked, so</span>
<span class="s2">as not to confuse it with the version available from LANL. Full text of the </span>
<span class="s2">Python Software Foundation License can be found in the LICENSE.md file in the</span>
<span class="s2">main development branch of the repository (https://github.com/spacepy/spacepy).</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">:</span>
    <span class="n">__license__</span> <span class="o">+=</span> \
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Fortran library support provided by MinGW. The MinGW base runtime package has been placed in the public domain, and is not governed by copyright.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">__citation__</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;When publishing research which used SpacePy, please provide appropriate</span>
<span class="s2">credit to the SpacePy team via citation or acknowledgement.</span>

<span class="s2">To cite SpacePy in publications, use (BibTeX code):</span>
<span class="s2">@INPROCEEDINGS{spacepy11,</span>
<span class="s2">author = {{Morley}, S.~K. and </span><span class="si">{Koller}</span><span class="s2">, J. and </span><span class="si">{Welling}</span><span class="s2">, D.~T. and </span><span class="si">{Larsen}</span><span class="s2">, B.~A. and </span><span class="si">{Henderson}</span><span class="s2">, M.~G. and </span><span class="si">{Niehof}</span><span class="s2">, J.~T.},</span>
<span class="s2">title = &quot;{Spacepy - A Python-based library of tools for the space sciences}&quot;,</span>
<span class="s2">booktitle = &quot;{Proceedings of the 9th Python in science conference (SciPy 2010)}&quot;,</span>
<span class="s2">year = 2011,</span>
<span class="s2">address = {Austin, TX}</span>
<span class="s2">}</span>

<span class="s2">Certain modules may provide additional citations in the __citation__</span>
<span class="s2">attribute. Contact a module&#39;s author before publication or public</span>
<span class="s2">presentation of analysis performed by that module. This allows the author</span>
<span class="s2">to validate the analysis and receive appropriate credit for his or her</span>
<span class="s2">work.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1">#Global spacepy configuration information</span>
<span class="n">config</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">def</span> <span class="nf">_write_defaults</span><span class="p">(</span><span class="n">rcfile</span><span class="p">,</span> <span class="n">defaults</span><span class="p">,</span> <span class="n">section</span><span class="o">=</span><span class="s1">&#39;spacepy&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Write configuration defaults out to a file if they aren&#39;t there&quot;&quot;&quot;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">rcfile</span><span class="p">,</span> <span class="s1">&#39;r+t&#39;</span><span class="p">)</span> <span class="c1">#Avoid race condition, open for read and write</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">startpos</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
        <span class="n">rclines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">writeme</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">defaults</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="c1">#Places where sections start</span>
        <span class="n">secidx</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rclines</span><span class="p">))</span>
                  <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^\[[^\[\]]*\]\n$&quot;</span><span class="p">,</span> <span class="n">rclines</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>
        <span class="c1">#Line containing the start of this section</span>
        <span class="n">thissec</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">secidx</span>
                        <span class="k">if</span> <span class="n">rclines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;[</span><span class="si">{section}</span><span class="s1">]</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">)),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">thissec</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="c1">#this section exists, read it</span>
            <span class="c1">#Find the line that starts the next section</span>
            <span class="n">nextsecidx</span> <span class="o">=</span> <span class="n">secidx</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">thissec</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">nextsecidx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">secidx</span><span class="p">):</span>
                <span class="n">nextsec</span> <span class="o">=</span> <span class="n">secidx</span><span class="p">[</span><span class="n">nextsecidx</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nextsec</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1">#Read only this section for lines matching default values</span>
            <span class="n">present</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">rclines</span><span class="p">[</span><span class="n">thissec</span><span class="p">:</span><span class="n">nextsec</span><span class="p">]:</span>
                <span class="c1">#For each key, does the line match, commented or not?</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">writeme</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(#\s?)?</span><span class="si">{key}</span><span class="s1">\s?[:=]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">k</span><span class="p">),</span>
                                <span class="n">l</span><span class="p">):</span>
                        <span class="n">writeme</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                        <span class="k">break</span>
        <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">startpos</span><span class="p">)</span> <span class="c1">#Back to start of file</span>
        <span class="c1">#Scan to just after section header. Text mode, can only seek() to tell()</span>
        <span class="k">if</span> <span class="n">thissec</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">while</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;[</span><span class="si">{section}</span><span class="s1">]</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">section</span><span class="o">=</span><span class="n">section</span><span class="p">):</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">:</span>
            <span class="c1">#Tickle the file for read/write switch</span>
            <span class="c1">#https://stackoverflow.com/questions/11176724/python-file-operations</span>
            <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c1">#Write default values for anything not read</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">writeme</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">((</span><span class="s2">&quot;#SpacePy </span><span class="si">{ver}</span><span class="s2"> default </span><span class="si">{key}</span><span class="s2">: </span><span class="si">{value}</span><span class="se">\n</span><span class="s2">&quot;</span>
                     <span class="s2">&quot;#</span><span class="si">{key}</span><span class="s2">: </span><span class="si">{value}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                         <span class="n">key</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ver</span><span class="o">=</span><span class="n">__version__</span><span class="p">))</span>
        <span class="c1">#And write all the remaining lines from the section header to end</span>
        <span class="k">if</span> <span class="n">writeme</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">rclines</span><span class="p">[</span><span class="n">thissec</span><span class="o">+</span><span class="mi">1</span><span class="p">:])</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="c1"># import some settings</span>
<span class="k">def</span> <span class="nf">_read_config</span><span class="p">(</span><span class="n">rcfile</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Read configuration information from a file&quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">config</span>
    <span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;enable_deprecation_warning&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span>
                <span class="s1">&#39;keepalive&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span>
                <span class="s1">&#39;ncpus&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()),</span>
                <span class="s1">&#39;qindenton_url&#39;</span><span class="p">:</span> <span class="s1">&#39;http://virbo.org/ftp/QinDenton/hour/merged/latest/WGhour-latest.d.zip&#39;</span><span class="p">,</span>
                <span class="s1">&#39;qd_daily_url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://rbsp-ect.newmexicoconsortium.org/data_pub/QinDenton/&#39;</span><span class="p">,</span>
                <span class="s1">&#39;omni2_url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://spdf.gsfc.nasa.gov/pub/data/omni/omni_cdaweb/hourly/&#39;</span><span class="p">,</span>
                <span class="s1">&#39;leapsec_url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://maia.usno.navy.mil/ser7/tai-utc.dat&#39;</span><span class="p">,</span>
                <span class="s1">&#39;psddata_url&#39;</span><span class="p">:</span> <span class="s1">&#39;http://spacepy.lanl.gov/repository/psd_dat.sqlite&#39;</span><span class="p">,</span>
                <span class="s1">&#39;support_notice&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span>
                <span class="s1">&#39;apply_plot_styles&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span>
                <span class="s1">&#39;enable_old_data_warning&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="kc">True</span><span class="p">),</span>
                <span class="p">}</span>
    <span class="c1">#Functions to cast a config value; if not specified, value is a string</span>
    <span class="n">str2bool</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">,</span> <span class="s1">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">caster</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;enable_deprecation_warning&#39;</span><span class="p">:</span> <span class="n">str2bool</span><span class="p">,</span>
              <span class="s1">&#39;keepalive&#39;</span><span class="p">:</span> <span class="n">str2bool</span><span class="p">,</span>
              <span class="s1">&#39;ncpus&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
              <span class="s1">&#39;support_notice&#39;</span><span class="p">:</span> <span class="n">str2bool</span><span class="p">,</span>
              <span class="s1">&#39;apply_plot_styles&#39;</span><span class="p">:</span> <span class="n">str2bool</span><span class="p">,</span>
              <span class="s1">&#39;enable_old_data_warning&#39;</span><span class="p">:</span> <span class="n">str2bool</span><span class="p">,</span>
              <span class="p">}</span>
    <span class="c1">#SafeConfigParser deprecated in 3.2. And this is hideous, but...</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ConfigParser</span><span class="p">,</span> <span class="s1">&#39;SafeConfigParser&#39;</span><span class="p">):</span>
        <span class="n">cp_class</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">SafeConfigParser</span>
        <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">(</span><span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">w</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
                <span class="s1">&#39;always&#39;</span><span class="p">,</span> <span class="s1">&#39;The SafeConfigParser class has been renamed.*&#39;</span><span class="p">,</span>
                <span class="ne">DeprecationWarning</span><span class="p">,</span>
                <span class="s1">&#39;^spacepy$&#39;</span><span class="p">)</span> <span class="c1">#configparser lies about source of warnings</span>
            <span class="n">ConfigParser</span><span class="o">.</span><span class="n">SafeConfigParser</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">this_w</span> <span class="ow">in</span> <span class="n">w</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">this_w</span><span class="o">.</span><span class="n">message</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">):</span>
                <span class="n">cp_class</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">ConfigParser</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="n">this_w</span><span class="o">.</span><span class="n">message</span><span class="p">,</span> <span class="n">this_w</span><span class="o">.</span><span class="n">category</span><span class="p">,</span>
                                     <span class="n">this_w</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">this_w</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span>
                                     <span class="n">this_w</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="n">this_w</span><span class="o">.</span><span class="n">line</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cp_class</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">ConfigParser</span>
    <span class="n">cp</span> <span class="o">=</span> <span class="n">cp_class</span><span class="p">(</span><span class="n">defaults</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">successful</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">read</span><span class="p">([</span><span class="n">rcfile</span><span class="p">])</span>
    <span class="k">except</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">Error</span><span class="p">:</span>
        <span class="n">successful</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">successful</span><span class="p">:</span>  <span class="c1"># New file structure</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s1">&#39;spacepy&#39;</span><span class="p">))</span>
        <span class="k">except</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">NoSectionError</span><span class="p">:</span>
            <span class="n">successful</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">config</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">successful</span><span class="p">:</span>  <span class="c1"># Old or bad file structure, wipe it out</span>
        <span class="n">cp</span> <span class="o">=</span> <span class="n">cp_class</span><span class="p">()</span>
        <span class="n">cp</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s1">&#39;spacepy&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">rcfile</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cf</span><span class="p">:</span>
            <span class="n">cp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cf</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">defaults</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
                <span class="n">config</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="n">_write_defaults</span><span class="p">(</span><span class="n">rcfile</span><span class="p">,</span> <span class="n">defaults</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">caster</span><span class="p">:</span>
        <span class="n">config</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">caster</span><span class="p">[</span><span class="n">k</span><span class="p">](</span><span class="n">config</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">_find_spacepy_dir</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Determine the .spacepy directory (DOT_FLN)</span>

<span class="sd">    This does not create the directory (although will create the parent</span>
<span class="sd">    directory if ``SPACEPY`` environment variable is set).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    DOT_FLN : str</span>
<span class="sd">        Full path to the .spacepy directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;SPACEPY&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
        <span class="n">parentdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;SPACEPY&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">parentdir</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">parentdir</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">errno</span> <span class="o">!=</span> <span class="n">errno</span><span class="o">.</span><span class="n">EEXIST</span><span class="p">:</span>  <span class="c1"># FileExistsError in 3.3+</span>
                    <span class="k">raise</span>
    <span class="k">elif</span> <span class="s1">&#39;HOME&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
        <span class="n">parentdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="s1">&#39;HOMEDRIVE&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span> <span class="ow">and</span> <span class="s1">&#39;HOMEPATH&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
        <span class="n">parentdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOMEDRIVE&#39;</span><span class="p">],</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOMEPATH&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">parentdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parentdir</span><span class="p">,</span> <span class="s1">&#39;.spacepy&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_populate_spacepy_dir</span><span class="p">(</span><span class="n">DOT_FLN</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create .spacepy directory and populate.</span>

<span class="sd">    Makes sure created and data directory exists.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    DOT_FLN : str</span>
<span class="sd">        Full path to the .spacepy directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DOT_FLN</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">DOT_FLN</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">errno</span> <span class="o">!=</span> <span class="n">errno</span><span class="o">.</span><span class="n">EEXIST</span><span class="p">:</span>
                <span class="k">raise</span>
    <span class="n">dataout</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DOT_FLN</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dataout</span><span class="p">):</span>
        <span class="n">datadir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span>
                               <span class="s1">&#39;data&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">dataout</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">errno</span> <span class="o">!=</span> <span class="n">errno</span><span class="o">.</span><span class="n">EEXIST</span><span class="p">:</span>
                <span class="k">raise</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">datadir</span><span class="p">,</span> <span class="s1">&#39;tai-utc.dat&#39;</span><span class="p">),</span> <span class="n">dataout</span><span class="p">)</span>
        <span class="c1"># Set permissions based on umask, not perms in SpacePy install</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">umask</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">umask</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chmod</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dataout</span><span class="p">,</span> <span class="s1">&#39;tai-utc.dat&#39;</span><span class="p">),</span> <span class="mo">0o666</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">u</span><span class="p">)</span>


<span class="n">DOT_FLN</span> <span class="o">=</span> <span class="n">_find_spacepy_dir</span><span class="p">()</span>
<span class="n">_populate_spacepy_dir</span><span class="p">(</span><span class="n">DOT_FLN</span><span class="p">)</span>
<span class="n">rcfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DOT_FLN</span><span class="p">,</span> <span class="s1">&#39;spacepy.rc&#39;</span><span class="p">)</span>
<span class="n">_read_config</span><span class="p">(</span><span class="n">rcfile</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__version__</span> <span class="o">==</span> <span class="s1">&#39;UNRELEASED&#39;</span> <span class="ow">and</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;support_notice&#39;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This unreleased version of SpacePy is not supported &#39;</span>
          <span class="s1">&#39;by the SpacePy team.&#39;</span><span class="p">)</span>
<span class="c1"># Set up a filter to always warn on deprecation</span>
<span class="k">if</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;enable_deprecation_warning&#39;</span><span class="p">]:</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">,</span>
                            <span class="s1">&#39;^spacepy&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="https://spacepy.github.io/"">homepage</a>|&nbsp;</li>
        <li><a href="https://github.com/spacepy/spacepy">development</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
       <li><a href="../index.html">documentation </a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">spacepy</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2011-2022, The SpacePy Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    </div>
  </body>
</html>