
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>spacepy.irbempy.get_Lstar &#8212; SpacePy v0.4.0 Manual</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/default.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/copybutton.js"></script>
    
    <link rel="shortcut icon" href="../_static/spacepy_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="spacepy.irbempy.find_Bmirror" href="spacepy.irbempy.find_Bmirror.html" />
    <link rel="prev" title="spacepy.irbempy.get_Lm" href="spacepy.irbempy.get_Lm.html" /> 
  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../index.html"><img src="../_static/spacepy_logo.jpg" border="0" alt="spacepy_logo"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="spacepy.irbempy.find_Bmirror.html" title="spacepy.irbempy.find_Bmirror"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="spacepy.irbempy.get_Lm.html" title="spacepy.irbempy.get_Lm"
             accesskey="P">previous</a> |</li>
        <li><a href="https://spacepy.github.io/"">homepage</a>|&nbsp;</li>
        <li><a href="https://github.com/spacepy/spacepy">development</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
       <li><a href="../index.html">documentation </a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../irbempy.html" accesskey="U">irbempy - Python interface to IRBEM library</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">spacepy.irbempy.get_Lstar</a></li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="spacepy.irbempy.get_Lm.html"
                          title="previous chapter">spacepy.irbempy.get_Lm</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="spacepy.irbempy.find_Bmirror.html"
                          title="next chapter">spacepy.irbempy.find_Bmirror</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/autosummary/spacepy.irbempy.get_Lstar.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="spacepy-irbempy-get-lstar">
<h1>spacepy.irbempy.get_Lstar<a class="headerlink" href="#spacepy-irbempy-get-lstar" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="spacepy.irbempy.get_Lstar">
<span class="sig-prename descclassname"><span class="pre">spacepy.irbempy.</span></span><span class="sig-name descname"><span class="pre">get_Lstar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ticks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">90</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extMag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'T01STORM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omnivals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landi2lstar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spacepy/irbempy/irbempy.html#get_Lstar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#spacepy.irbempy.get_Lstar" title="Permalink to this definition">¶</a></dt>
<dd><p>This will call make_lstar1 or make_lstar_shell_splitting_1 from the irbem library
and will lookup omni values for given time if not provided (optional). If pitch angles
are provided, drift shell splitting will be calculated and “Bmirr” will be returned. If they
are not provided, then no drift shell splitting is calculated and “Blocal” is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>- ticks (Ticktock class)</strong><span class="classifier">containing time information</span></dt><dd></dd>
<dt><strong>- loci (Coords class)</strong><span class="classifier">containing spatial information</span></dt><dd></dd>
<dt><strong>- alpha (list or ndarray)</strong><span class="classifier">optional pitch angles in degrees (default is 90);</span></dt><dd><p>if provided will calculate shell splitting; max 25 values</p>
</dd>
<dt><strong>- extMag (string)</strong><span class="classifier">optional; will choose the external magnetic field model</span></dt><dd><p>possible values [‘0’, ‘MEAD’, ‘T87SHORT’, ‘T87LONG’, ‘T89’,
‘OPQUIET’, ‘OPDYN’, ‘T96’, ‘OSTA’, ‘T01QUIET’, ‘T01STORM’,
‘T05’, ‘ALEX’, ‘TS07’]</p>
</dd>
<dt><strong>- options (optional list or array of integers length=5)</strong><span class="classifier">explained below</span></dt><dd></dd>
<dt><strong>- omni values as dictionary (optional)</strong><span class="classifier">if not provided, will use lookup table</span></dt><dd></dd>
<dt><strong>- landi2lstar</strong><span class="classifier">if True, will use the faster landi2lstar routine if possible. This</span></dt><dd><p>routine can only be used with OPQUIET+IGRF magnetic field models.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>- results (dictionary)</strong><span class="classifier">containing keys: Lm, Lstar, Bmin, Blocal (or Bmirr), Xj, MLT</span></dt><dd><p>if pitch angles provided in “alpha” then drift shells are calculated and “Bmirr”
is returned if not provided, then “Blocal” at spacecraft is returned. A negative
value for Lm indicates the field line is closed but particles are lost to the
atmosphere; the absolute value indicates the L value. A negative value for Lstar
indicates the field line is closed but particles are lost to the atmosphere
before completing a drift orbit; the absolute value indicates the drift shell.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>External Field</dt><dd><ul class="simple">
<li><p>0        : no external field</p></li>
<li><p>MEAD  : Mead &amp; Fairfield [1975] (uses 0&lt;=Kp&lt;=9 - Valid for rGEO&lt;=17. Re)</p></li>
<li><p>T87SHORT: Tsyganenko short [1987] (uses 0&lt;=Kp&lt;=9 - Valid for rGEO&lt;=30. Re)</p></li>
<li><p>T87LONG : Tsyganenko long [1987] (uses 0&lt;=Kp&lt;=9 - Valid for rGEO&lt;=70. Re)</p></li>
<li><p>T89    : Tsyganenko [1989] (uses 0&lt;=Kp&lt;=9 - Valid for rGEO&lt;=70. Re)</p></li>
<li><p>OPQUIET : Olson &amp; Pfitzer quiet [1977] (default - Valid for rGEO&lt;=15. Re)</p></li>
<li><dl class="simple">
<dt>OPDYN<span class="classifier">Olson &amp; Pfitzer dynamic [1988] (uses 5.&lt;=dens&lt;=50., 300.&lt;=velo&lt;=500.,</span></dt><dd><p>-100.&lt;=Dst&lt;=20. - Valid for rGEO&lt;=60. Re)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>T96<span class="classifier">Tsyganenko [1996] (uses -100.&lt;=Dst (nT)&lt;=20., 0.5&lt;=Pdyn (nPa)&lt;10.,</span></dt><dd><p>abs(ByIMF) (nT)&lt;1=0., abs(BzIMF) (nT)&lt;=10. - Valid for rGEO&lt;=40. Re)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>OSTA<span class="classifier">Ostapenko &amp; Maltsev [1997] (uses dst,Pdyn,BzIMF, Kp)</span></dt><dd><p>T01QUIET: Tsyganenko [2002a,b] (uses -50.&lt;Dst (nT)&lt;20., 0.5&lt;Pdyn (nPa)&lt;=5.,
abs(ByIMF) (nT)&lt;=5., abs(BzIMF) (nT)&lt;=5., 0.&lt;=G1&lt;=10., 0.&lt;=G2&lt;=10. - Valid for xGSM&gt;=-15. Re)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>T01STORM: Tsyganenko, Singer &amp; Kasper [2003] storm  (uses Dst, Pdyn, ByIMF, BzIMF, G2, G3 -</dt><dd><p>there is no upper or lower limit for those inputs - Valid for xGSM&gt;=-15. Re)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>T05<span class="classifier">Tsyganenko &amp; Sitnov [2005] storm  (uses Dst, Pdyn, ByIMF, BzIMF,</span></dt><dd><p>W1, W2, W3, W4, W5, W6 - no upper or lower limit for inputs - Valid for xGSM&gt;=-15. Re)</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>OMNI contents</dt><dd><ul class="simple">
<li><p>Kp: value of Kp as in OMNI2 files but has to be double instead of integer type</p></li>
<li><p>Dst: Dst index (nT)</p></li>
<li><p>dens: Solar Wind density (cm-3)</p></li>
<li><p>velo: Solar Wind velocity (km/s)</p></li>
<li><p>Pdyn: Solar Wind dynamic pressure (nPa)</p></li>
<li><p>ByIMF: GSM y component of IMF mag. field (nT)</p></li>
<li><p>BzIMF: GSM z component of IMF mag. field (nT)</p></li>
<li><dl class="simple">
<dt>G1:  G1=&lt; Vsw*(Bperp/40)2/(1+Bperp/40)*sin3(theta/2) &gt; where the &lt;&gt; mean an average over the</dt><dd><p>previous 1 hour, Vsw is the solar wind speed, Bperp is the transverse IMF
component (GSM) and theta it’s clock angle.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>G2: G2=&lt; a*Vsw*Bs &gt; where the &lt;&gt; mean an average over the previous 1 hour,</dt><dd><p>Vsw is solar wind speed, Bs=|IMF Bz| when IMF Bz &lt; 0 and Bs=0 when IMF Bz &gt; 0, a=0.005.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>G3:  G3=&lt; Vsw*Dsw*Bs /2000.&gt; where the &lt;&gt; mean an average over the previous 1 hour,</dt><dd><p>Vsw is the solar wind speed, Dsw is the solar wind density, Bs=|IMF Bz| when IMF
Bz &lt; 0 and Bs=0 when IMF Bz &gt; 0.</p>
</dd>
</dl>
</li>
<li><p>W1 - W6: see definition in (JGR-A, v.110(A3), 2005.) (PDF 1.2MB)</p></li>
<li><p>AL: the auroral index</p></li>
</ul>
</dd>
<dt>Options</dt><dd><ul class="simple">
<li><p>1st element: 0 - don’t compute L* or phi ;  1 - compute L*; 2- compute phi</p></li>
<li><dl class="simple">
<dt>2nd element: 0 - initialize IGRF field once per year (year.5);</dt><dd><p>n - n is the  frequency (in days) starting on January 1st of each year
(i.e. if options(2nd element)=15 then IGRF will be updated on the following days of the
year: 1, 15, 30, 45 …)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>3rd element: resolution to compute L* (0 to 9) where 0 is the recomended value to ensure a</dt><dd><p>good ratio precision/computation time
(i.e. an error of ~2% at L=6). The higher the value the better will be the precision, the
longer will be the computing time. Generally there is not much improvement for values
larger than 4. Note that this parameter defines the integration step (theta)
along the field line such as dtheta=(2pi)/(720*[options(3rd element)+1])</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>4th element: resolution to compute L* (0 to 9). The higher the value the better will be</dt><dd><p>the precision, the longer will be
the computing time. It is recommended to use 0 (usually sufficient) unless L* is not
computed on a LEO orbit. For LEO orbit higher values are recommended. Note that this
parameter defines the integration step (phi) along the drift shell such as
dphi=(2pi)/(25*[options(4th element)+1])</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>5th element: allows to select an internal magnetic field model (default is set to IGRF)</dt><dd><ul>
<li><p>0 = IGRF</p></li>
<li><p>1 = Eccentric tilted dipole</p></li>
<li><p>2 = Jensen&amp;Cain 1960</p></li>
<li><p>3 = GSFC 12/66 updated to 1970</p></li>
<li><p>4 = User-defined model (Default: Centred dipole + uniform [Dungey open model] )</p></li>
<li><p>5 = Centred dipole</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">([</span><span class="s1">&#39;2002-02-02T12:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2002-02-02T12:10:00&#39;</span><span class="p">],</span> <span class="s1">&#39;ISO&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;GEO&#39;</span><span class="p">,</span> <span class="s1">&#39;car&#39;</span><span class="p">,</span> <span class="n">use_irbem</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spacepy</span><span class="o">.</span><span class="n">irbempy</span><span class="o">.</span><span class="n">Lstar</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="go">{&#39;Blocal&#39;: array([ 1020.40493286,  3446.08845227]),</span>
<span class="go">    &#39;Bmin&#39;: array([ 1019.98404311,  3437.63865243]),</span>
<span class="go">    &#39;Lm&#39;: array([ 3.08948304,  2.06022102]),</span>
<span class="go">    &#39;Lstar&#39;: array([ 2.97684043,  1.97868577]),</span>
<span class="go">    &#39;MLT&#39;: array([ 23.5728333 ,  23.57287944]),</span>
<span class="go">    &#39;Xj&#39;: array([ 0.00112884,  0.00286955])}</span>
</pre></div>
</div>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="spacepy.irbempy.find_Bmirror.html" title="spacepy.irbempy.find_Bmirror"
             >next</a> |</li>
        <li class="right" >
          <a href="spacepy.irbempy.get_Lm.html" title="spacepy.irbempy.get_Lm"
             >previous</a> |</li>
        <li><a href="https://spacepy.github.io/"">homepage</a>|&nbsp;</li>
        <li><a href="https://github.com/spacepy/spacepy">development</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
       <li><a href="../index.html">documentation </a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../irbempy.html" >irbempy - Python interface to IRBEM library</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">spacepy.irbempy.get_Lstar</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2011-2022, The SpacePy Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    </div>
  </body>
</html>