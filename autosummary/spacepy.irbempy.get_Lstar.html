<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>spacepy.irbempy.get_Lstar &mdash; SpacePy v0.2.1 Manual</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/spacepy_favicon.ico"/>
    <link rel="top" title="SpacePy v0.2.1 Manual" href="../index.html" />
    <link rel="up" title="irbempy - Python interface to irbem/ONERA library" href="../irbempy.html" />
    <link rel="next" title="spacepy.irbempy.find_Bmirror" href="spacepy.irbempy.find_Bmirror.html" />
    <link rel="prev" title="spacepy.irbempy.get_Lm" href="spacepy.irbempy.get_Lm.html" /> 
  </head>
  <body role="document">

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../index.html"><img src="../_static/spacepy_logo.jpg" border="0" alt="spacepy_logo"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="spacepy.irbempy.find_Bmirror.html" title="spacepy.irbempy.find_Bmirror"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="spacepy.irbempy.get_Lm.html" title="spacepy.irbempy.get_Lm"
             accesskey="P">previous</a> |</li>
        <li><a href="https://github.com/spacepy/spacepy">homepage</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
       <li><a href="../index.html">documentation </a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../irbempy.html" accesskey="U">irbempy - Python interface to irbem/ONERA library</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="spacepy.irbempy.get_Lm.html"
                        title="previous chapter">spacepy.irbempy.get_Lm</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="spacepy.irbempy.find_Bmirror.html"
                        title="next chapter">spacepy.irbempy.find_Bmirror</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/autosummary/spacepy.irbempy.get_Lstar.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="spacepy-irbempy-get-lstar">
<h1>spacepy.irbempy.get_Lstar<a class="headerlink" href="#spacepy-irbempy-get-lstar" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="spacepy.irbempy.get_Lstar">
<code class="descclassname">spacepy.irbempy.</code><code class="descname">get_Lstar</code><span class="sig-paren">(</span><em>ticks, loci, alpha=90, extMag='T01STORM', options=[1, 0, 0, 0, 0], omnivals=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/spacepy/irbempy/irbempy.html#get_Lstar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#spacepy.irbempy.get_Lstar" title="Permalink to this definition">¶</a></dt>
<dd><p>This will call make_lstar1 or make_lstar_shell_splitting_1 from the irbem library
and will lookup omni values for given time if not provided (optional). If pitch angles
are provided, drift shell splitting will be calculated and &#8220;Bmirr&#8221; will be returned. If they
are not provided, then no drift shell splitting is calculated and &#8220;Blocal&#8221; is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>- ticks (Ticktock class)</strong> : containing time information</p>
<blockquote>
<div><ul>
<li><p class="first">loci (Coords class) : containing spatial information</p>
</li>
<li><dl class="first docutils">
<dt>alpha (list or ndarray) <span class="classifier-delimiter">:</span> <span class="classifier">optional pitch angles in degrees (default is 90);</span></dt>
<dd><p class="first last">if provided will calculate shell splitting; max 25 values</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>extMag (string) <span class="classifier-delimiter">:</span> <span class="classifier">optional; will choose the external magnetic field model </span></dt>
<dd><p class="first last">possible values [&#8216;0&#8217;, &#8216;MEAD&#8217;, &#8216;T87SHORT&#8217;, &#8216;T87LONG&#8217;, &#8216;T89&#8217;, 
&#8216;OPQUIET&#8217;, &#8216;OPDYN&#8217;, &#8216;T96&#8217;, &#8216;OSTA&#8217;, &#8216;T01QUIET&#8217;, &#8216;T01STORM&#8217;, 
&#8216;T05&#8217;, &#8216;ALEX&#8217;, &#8216;TS07&#8217;]</p>
</dd>
</dl>
</li>
<li><p class="first">options (optional list or array of integers length=5) : explained below</p>
</li>
<li><p class="first">omni values as dictionary (optional) : if not provided, will use lookup table</p>
</li>
</ul>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>- results (dictionary)</strong> : containing keys: Lm, Lstar, Bmin, Blocal (or Bmirr), Xj, MLT</p>
<blockquote class="last">
<div><p>if pitch angles provided in &#8220;alpha&#8221; then drift shells are calculated and &#8220;Bmirr&#8221; 
is returned if not provided, then &#8220;Blocal&#8221; at spacecraft is returned. A negative
value for Lm indicates the field line is closed but particles are lost to the
atmosphere; the absolute value indicates the L value. A negative value for Lstar
indicates the field line is closed but particles are lost to the atmosphere
before completing a drift orbit; the absolute value indicates the drift shell.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<dl class="docutils">
<dt>External Field</dt>
<dd><ul class="first last">
<li><p class="first">0        : no external field</p>
</li>
<li><p class="first">MEAD  : Mead &amp; Fairfield [1975] (uses 0&lt;=Kp&lt;=9 - Valid for rGEO&lt;=17. Re)</p>
</li>
<li><p class="first">T87SHORT: Tsyganenko short [1987] (uses 0&lt;=Kp&lt;=9 - Valid for rGEO&lt;=30. Re)</p>
</li>
<li><p class="first">T87LONG : Tsyganenko long [1987] (uses 0&lt;=Kp&lt;=9 - Valid for rGEO&lt;=70. Re)</p>
</li>
<li><p class="first">T89    : Tsyganenko [1989] (uses 0&lt;=Kp&lt;=9 - Valid for rGEO&lt;=70. Re)</p>
</li>
<li><p class="first">OPQUIET : Olson &amp; Pfitzer quiet [1977] (default - Valid for rGEO&lt;=15. Re)</p>
</li>
<li><dl class="first docutils">
<dt>OPDYN <span class="classifier-delimiter">:</span> <span class="classifier">Olson &amp; Pfitzer dynamic [1988] (uses 5.&lt;=dens&lt;=50., 300.&lt;=velo&lt;=500., </span></dt>
<dd><p class="first last">-100.&lt;=Dst&lt;=20. - Valid for rGEO&lt;=60. Re)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>T96 <span class="classifier-delimiter">:</span> <span class="classifier">Tsyganenko [1996] (uses -100.&lt;=Dst (nT)&lt;=20., 0.5&lt;=Pdyn (nPa)&lt;10., </span></dt>
<dd><p class="first last">abs(ByIMF) (nT)&lt;1=0., abs(BzIMF) (nT)&lt;=10. - Valid for rGEO&lt;=40. Re)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>OSTA <span class="classifier-delimiter">:</span> <span class="classifier">Ostapenko &amp; Maltsev [1997] (uses dst,Pdyn,BzIMF, Kp)</span></dt>
<dd><p class="first last">T01QUIET: Tsyganenko [2002a,b] (uses -50.&lt;Dst (nT)&lt;20., 0.5&lt;Pdyn (nPa)&lt;=5., 
abs(ByIMF) (nT)&lt;=5., abs(BzIMF) (nT)&lt;=5., 0.&lt;=G1&lt;=10., 0.&lt;=G2&lt;=10. - Valid for xGSM&gt;=-15. Re)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>T01STORM: Tsyganenko, Singer &amp; Kasper [2003] storm  (uses Dst, Pdyn, ByIMF, BzIMF, G2, G3 - </dt>
<dd><p class="first last">there is no upper or lower limit for those inputs - Valid for xGSM&gt;=-15. Re)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>T05 <span class="classifier-delimiter">:</span> <span class="classifier">Tsyganenko &amp; Sitnov [2005] storm  (uses Dst, Pdyn, ByIMF, BzIMF, </span></dt>
<dd><p class="first last">W1, W2, W3, W4, W5, W6 - no upper or lower limit for inputs - Valid for xGSM&gt;=-15. Re)</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>OMNI contents</dt>
<dd><ul class="first last">
<li><p class="first">Kp: value of Kp as in OMNI2 files but has to be double instead of integer type</p>
</li>
<li><p class="first">Dst: Dst index (nT)</p>
</li>
<li><p class="first">dens: Solar Wind density (cm-3)</p>
</li>
<li><p class="first">velo: Solar Wind velocity (km/s)</p>
</li>
<li><p class="first">Pdyn: Solar Wind dynamic pressure (nPa)</p>
</li>
<li><p class="first">ByIMF: GSM y component of IMF mag. field (nT)</p>
</li>
<li><p class="first">BzIMF: GSM z component of IMF mag. field (nT)</p>
</li>
<li><dl class="first docutils">
<dt>G1:  G1=&lt; Vsw*(Bperp/40)2/(1+Bperp/40)*sin3(theta/2) &gt; where the &lt;&gt; mean an average over the </dt>
<dd><p class="first last">previous 1 hour, Vsw is the solar wind speed, Bperp is the transverse IMF 
component (GSM) and theta it&#8217;s clock angle.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>G2: G2=&lt; a*Vsw*Bs &gt; where the &lt;&gt; mean an average over the previous 1 hour, </dt>
<dd><p class="first last">Vsw is solar wind speed, Bs=|IMF Bz| when IMF Bz &lt; 0 and Bs=0 when IMF Bz &gt; 0, a=0.005.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>G3:  G3=&lt; Vsw*Dsw*Bs /2000.&gt; where the &lt;&gt; mean an average over the previous 1 hour, </dt>
<dd><p class="first last">Vsw is the solar wind speed, Dsw is the solar wind density, Bs=|IMF Bz| when IMF 
Bz &lt; 0 and Bs=0 when IMF Bz &gt; 0.</p>
</dd>
</dl>
</li>
<li><p class="first">W1 - W6: see definition in (JGR-A, v.110(A3), 2005.) (PDF 1.2MB)</p>
</li>
<li><p class="first">AL: the auroral index</p>
</li>
</ul>
</dd>
<dt>Options</dt>
<dd><ul class="first last">
<li><p class="first">1st element: 0 - don&#8217;t compute L* or phi ;  1 - compute L*; 2- compute phi</p>
</li>
<li><dl class="first docutils">
<dt>2nd element: 0 - initialize IGRF field once per year (year.5);  </dt>
<dd><p class="first last">n - n is the  frequency (in days) starting on January 1st of each year 
(i.e. if options(2nd element)=15 then IGRF will be updated on the following days of the 
year: 1, 15, 30, 45 ...)</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>3rd element: resolution to compute L* (0 to 9) where 0 is the recomended value to ensure a </dt>
<dd><p class="first last">good ratio precision/computation time
(i.e. an error of ~2% at L=6). The higher the value the better will be the precision, the 
longer will be the computing time. Generally there is not much improvement for values 
larger than 4. Note that this parameter defines the integration step (theta) 
along the field line such as dtheta=(2pi)/(720*[options(3rd element)+1])</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>4th element: resolution to compute L* (0 to 9). The higher the value the better will be </dt>
<dd><p class="first last">the precision, the longer will be 
the computing time. It is recommended to use 0 (usually sufficient) unless L* is not 
computed on a LEO orbit. For LEO orbit higher values are recommended. Note that this 
parameter defines the integration step (phi) along the drift shell such as 
dphi=(2pi)/(25*[options(4th element)+1])</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>5th element: allows to select an internal magnetic field model (default is set to IGRF)</dt>
<dd><ul class="first last simple">
<li>0 = IGRF</li>
<li>1 = Eccentric tilted dipole</li>
<li>2 = Jensen&amp;Cain 1960</li>
<li>3 = GSFC 12/66 updated to 1970</li>
<li>4 = User-defined model (Default: Centred dipole + uniform [Dungey open model] )</li>
<li>5 = Centred dipole</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Ticktock</span><span class="p">([</span><span class="s1">&#39;2002-02-02T12:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2002-02-02T12:10:00&#39;</span><span class="p">],</span> <span class="s1">&#39;ISO&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">Coords</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;GEO&#39;</span><span class="p">,</span> <span class="s1">&#39;car&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spacepy</span><span class="o">.</span><span class="n">irbempy</span><span class="o">.</span><span class="n">Lstar</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="go">{&#39;Blocal&#39;: array([ 1020.40493286,  3446.08845227]),</span>
<span class="go">    &#39;Bmin&#39;: array([ 1019.98404311,  3437.63865243]),</span>
<span class="go">    &#39;Lm&#39;: array([ 3.08948304,  2.06022102]),</span>
<span class="go">    &#39;Lstar&#39;: array([ 2.97684043,  1.97868577]),</span>
<span class="go">    &#39;MLT&#39;: array([ 23.5728333 ,  23.57287944]),</span>
<span class="go">    &#39;Xj&#39;: array([ 0.00112884,  0.00286955])}</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="spacepy.irbempy.find_Bmirror.html" title="spacepy.irbempy.find_Bmirror"
             >next</a> |</li>
        <li class="right" >
          <a href="spacepy.irbempy.get_Lm.html" title="spacepy.irbempy.get_Lm"
             >previous</a> |</li>
        <li><a href="https://github.com/spacepy/spacepy">homepage</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
       <li><a href="../index.html">documentation </a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../irbempy.html" >irbempy - Python interface to irbem/ONERA library</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2011-2019, The SpacePy Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
  </body>
</html>